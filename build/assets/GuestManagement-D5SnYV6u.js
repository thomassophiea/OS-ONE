import{j as e}from"./vendor-ui-CO0mBmim.js";import{a as n}from"./vendor-react-BQC692LR.js";import{a as h,w as r,t as C,B as i,C as j,b as p,c as g,d as f,h as q,e as D,L as N,I as y}from"./index-CrdvL8SR.js";import{D as z,a as B,b as L,c as $,d as I,e as P}from"./dialog-BqYeg193.js";import{a as o,R as G,a3 as E,a1 as H,bA as U,a6 as J,bE as O,a0 as K}from"./vendor-icons-DmoIqCnf.js";import"./vendor-charts-CCS-1Xlq.js";function ee(){const[l,F]=n.useState([]),[A,b]=n.useState(!0),[k,d]=n.useState(!1),[v,w]=n.useState(!1),[a,c]=n.useState({name:"",email:"",duration:"24",company:""});n.useEffect(()=>{m()},[]);const m=async()=>{b(!0);try{const s=await h.getGuests();F(s)}catch(s){console.error("Failed to load guests:",s),r.error("Failed to load guest accounts")}finally{b(!1)}},S=s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s),R=async()=>{if(!a.name||!a.email){r.error("Please fill in all required fields");return}if(!S(a.email)){r.error("Please enter a valid email address");return}const s=parseInt(a.duration);if(s<1||s>168){r.error("Duration must be between 1 and 168 hours (7 days)");return}w(!0);try{await h.createGuest({name:a.name,email:a.email,duration:s*60*60,company:a.company}),r.success("Guest account created successfully"),d(!1),c({name:"",email:"",duration:"24",company:""}),await m()}catch(t){console.error("Failed to create guest:",t),r.error("Failed to create guest account")}finally{w(!1)}},T=async s=>{if(confirm("Are you sure you want to delete this guest account?"))try{await h.deleteGuest(s),r.success("Guest account deleted"),await m()}catch(t){console.error("Failed to delete guest:",t),r.error("Failed to delete guest account")}},M=async s=>{try{const t=await h.generateGuestVoucher(s);r.success("Voucher generated successfully"),console.log("Voucher:",t)}catch(t){console.error("Failed to generate voucher:",t),r.error("Failed to generate voucher")}},u=s=>new Date(s).getTime()<Date.now(),V=s=>{const t=new Date(s),x=Math.ceil((t.getTime()-Date.now())/(1e3*60*60));return x<0?"Expired":x<1?"Expires soon":x<24?`Expires in ${x}h`:t.toLocaleDateString()};return A?e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsx(C,{className:"h-8 w-64"}),e.jsx(C,{className:"h-96 w-full"})]}):e.jsxs("div",{className:"space-y-6 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(o,{className:"h-6 w-6"}),"Guest Management"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage guest wireless access accounts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:m,"aria-label":"Refresh guest list",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(i,{size:"sm",onClick:()=>d(!0),"aria-label":"Create new guest account",children:[e.jsx(o,{className:"h-4 w-4 mr-2"}),"Create Guest"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(j,{children:[e.jsx(p,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Total Guests"})}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"text-2xl font-bold",children:l.length})]})})]}),e.jsxs(j,{children:[e.jsx(p,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Active"})}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-2xl font-bold",children:l.filter(s=>!u(s.expirationDate)).length})]})})]}),e.jsxs(j,{children:[e.jsx(p,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Expired"})}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("span",{className:"text-2xl font-bold",children:l.filter(s=>u(s.expirationDate)).length})]})})]})]}),e.jsxs(j,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Guest Accounts"}),e.jsx(q,{children:"Manage temporary guest wireless access"})]}),e.jsx(f,{children:l.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(o,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No guest accounts"}),e.jsx("p",{className:"text-sm mt-2",children:"Create guest accounts for temporary access"})]}):e.jsx("div",{className:"space-y-2",children:l.map(s=>e.jsxs("div",{className:"flex items-start justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(o,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold",children:s.name}),u(s.expirationDate)?e.jsx(D,{variant:"outline",children:"Expired"}):e.jsx(D,{className:"bg-green-500",children:"Active"})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[s.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-3 w-3"}),e.jsx("span",{children:s.email})]}),s.company&&e.jsx("div",{children:e.jsxs("span",{children:["Company: ",s.company]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-3 w-3"}),e.jsx("span",{children:V(s.expirationDate)})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>M(s.id),disabled:u(s.expirationDate),"aria-label":`Generate voucher for ${s.name}`,children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Voucher"]}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>T(s.id),"aria-label":`Delete guest account for ${s.name}`,children:e.jsx(K,{className:"h-4 w-4 text-destructive"})})]})]},s.id))})})]}),e.jsx(z,{open:k,onOpenChange:d,children:e.jsxs(B,{children:[e.jsxs(L,{children:[e.jsx($,{children:"Create Guest Account"}),e.jsx(I,{children:"Create a temporary wireless access account for a guest"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"guest-name",children:"Guest Name *"}),e.jsx(y,{id:"guest-name",value:a.name,onChange:s=>c({...a,name:s.target.value}),placeholder:"John Doe","aria-label":"Enter guest name","aria-required":"true"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"guest-email",children:"Email Address *"}),e.jsx(y,{id:"guest-email",type:"email",value:a.email,onChange:s=>c({...a,email:s.target.value}),placeholder:"john@example.com","aria-label":"Enter guest email address","aria-required":"true","aria-describedby":"email-hint"}),e.jsx("p",{id:"email-hint",className:"text-xs text-muted-foreground",children:"A valid email address is required for guest access"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"guest-company",children:"Company"}),e.jsx(y,{id:"guest-company",value:a.company,onChange:s=>c({...a,company:s.target.value}),placeholder:"Acme Corp","aria-label":"Enter company name (optional)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"guest-duration",children:"Access Duration (hours)"}),e.jsx(y,{id:"guest-duration",type:"number",value:a.duration,onChange:s=>c({...a,duration:s.target.value}),min:"1",max:"168","aria-label":"Set access duration in hours","aria-describedby":"duration-hint"}),e.jsx("p",{id:"duration-hint",className:"text-xs text-muted-foreground",children:"Duration must be between 1 and 168 hours (7 days)"})]})]}),e.jsxs(P,{children:[e.jsx(i,{variant:"outline",onClick:()=>d(!1),disabled:v,"aria-label":"Cancel guest creation",children:"Cancel"}),e.jsx(i,{onClick:R,disabled:v,"aria-label":"Create guest account",children:v?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Account"]})})]})]})})]})}export{ee as GuestManagement};
