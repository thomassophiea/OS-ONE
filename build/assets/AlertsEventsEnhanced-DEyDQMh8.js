import{j as e}from"./vendor-ui-CO0mBmim.js";import{a as m}from"./vendor-react-BQC692LR.js";import{a as P,w as O,C as j,b as f,d as g,m as b,n as T,o as E,p as L,q as n,B as Ee,c as v,T as Le,i as ke,j as X,I as De,k as K,h as Q,S as Y,e as H}from"./index-CrdvL8SR.js";import{T as Z,a as _,b as k,c as u,d as ee,e as h}from"./table-BR47Ry2r.js";import{a1 as Re,R as Ie,y as se,x as te,B as ae,A as D,P as Fe,aV as ze,a3 as $e,I as re,S as ie,am as le,f as Me,W as Be}from"./vendor-icons-DmoIqCnf.js";import"./vendor-charts-CCS-1Xlq.js";function Je(){const[c,ne]=m.useState([]),[y,ce]=m.useState([]),[de,W]=m.useState(!0),[G,U]=m.useState(!1),[C,oe]=m.useState("alerts"),[S,me]=m.useState("all"),[p,ue]=m.useState("all"),[A,he]=m.useState("all"),[o,xe]=m.useState(""),[R,je]=m.useState("24h");m.useEffect(()=>{I();const s=setInterval(()=>{I(!0)},3e4);return()=>clearInterval(s)},[R]);const I=async(s=!1)=>{try{s?U(!0):W(!0);const a=Date.now(),x={"1h":36e5,"24h":864e5,"7d":6048e5,"30d":2592e6},l=a-(x[R]||x["24h"]);console.log("[AlertsEvents] Fetching alerts and events...");const[w,M,B]=await Promise.allSettled([P.makeAuthenticatedRequest("/v1/alerts",{method:"GET"},1e4),P.makeAuthenticatedRequest("/v1/events?type=all",{method:"GET"},1e4),P.makeAuthenticatedRequest("/v1/notifications",{method:"GET"},1e4)]);let V=[],N=[];if(w.status==="fulfilled"&&w.value.ok)try{const r=await w.value.json(),d=Array.isArray(r)?r:r.alerts||r.data||[];console.log("[AlertsEvents] Processing alerts:",d.length),V=d.filter(t=>(t.timestamp||t.time||t.createdAt||a)>=l).map(t=>({id:t.id||t.alertId||`alert-${Date.now()}-${Math.random()}`,type:t.type||t.alertType||"general",severity:ge(t.severity||t.level||t.priority),category:t.category||pe(t.type||t.message),message:t.message||t.name||t.title||"Alert",description:t.description||t.details||t.summary||"",source:t.source||t.deviceName||t.apName||"System",timestamp:t.timestamp||t.time||t.createdAt||a,status:fe(t.status||t.state),affectedDevices:t.affectedDevices||(t.deviceName?[t.deviceName]:[]),assignedTo:t.assignedTo||t.owner}))}catch(r){console.log("[AlertsEvents] Failed to parse alerts:",r)}else console.log("[AlertsEvents] Alerts endpoint not available");if(M.status==="fulfilled"&&M.value.ok)try{const r=await M.value.json(),d=Array.isArray(r)?r:r.events||r.data||[];console.log("[AlertsEvents] Processing events:",d.length),N=d.filter(t=>(t.timestamp||t.time||t.createdAt||a)>=l).map(t=>({id:t.id||t.eventId||`event-${Date.now()}-${Math.random()}`,type:t.type||t.eventType||"general",category:t.category||ve(t.type||t.message),message:t.message||t.name||t.title||"Event",description:t.description||t.details||"",source:t.source||t.deviceName||t.apName||"System",timestamp:t.timestamp||t.time||t.createdAt||a,severity:t.severity||t.level,user:t.user||t.userName||t.userId,device:t.device||t.deviceName||t.apName,details:t.details||t.metadata}))}catch(r){console.log("[AlertsEvents] Failed to parse events:",r)}if(B.status==="fulfilled"&&B.value.ok)try{const r=await B.value.json(),d=Array.isArray(r)?r:r.notifications||[];console.log("[AlertsEvents] Processing notifications:",d.length);const t=d.filter(i=>(i.timestamp||i.time||a)>=l).map(i=>({id:i.id||`notif-${Date.now()}-${Math.random()}`,type:i.type||"notification",category:i.category||"system",message:i.message||i.title||"Notification",description:i.description||"",source:i.source||"System",timestamp:i.timestamp||i.time||a,severity:i.severity,details:i.details})),q=new Set(N.map(i=>i.id));t.forEach(i=>{q.has(i.id)||N.push(i)})}catch(r){console.log("[AlertsEvents] Failed to parse notifications:",r)}V.sort((r,d)=>d.timestamp-r.timestamp),N.sort((r,d)=>d.timestamp-r.timestamp),ne(V),ce(N),s&&O.success("Data refreshed")}catch(a){console.error("[AlertsEvents] Error loading data:",a),O.error("Failed to load alerts and events")}finally{W(!1),U(!1)}},ge=s=>{const a=String(s||"").toLowerCase();return a.includes("critical")||a.includes("high")||a.includes("error")?"critical":a.includes("warning")||a.includes("warn")||a.includes("medium")?"warning":a.includes("info")||a.includes("information")?"info":"low"},fe=s=>{const a=String(s||"active").toLowerCase();return a.includes("ack")?"acknowledged":a.includes("resolve")||a.includes("closed")?"resolved":a.includes("clear")?"cleared":"active"},pe=s=>{const a=s.toLowerCase();return a.includes("security")||a.includes("auth")||a.includes("intrusion")?"security":a.includes("ap")||a.includes("access point")||a.includes("wifi")?"infrastructure":a.includes("client")||a.includes("user")||a.includes("station")?"clients":a.includes("network")||a.includes("connectivity")?"network":a.includes("performance")||a.includes("throughput")?"performance":"system"},ve=s=>{const a=s.toLowerCase();return a.includes("config")||a.includes("setting")?"configuration":a.includes("auth")||a.includes("login")||a.includes("logout")?"authentication":a.includes("connect")||a.includes("disconnect")?"connection":a.includes("update")||a.includes("upgrade")?"system":"general"},ye=s=>{switch(s){case"critical":return"destructive";case"warning":return"secondary";case"info":return"default";default:return"outline"}},we=s=>{switch(s){case"critical":return e.jsx(se,{className:"h-4 w-4"});case"warning":return e.jsx(te,{className:"h-4 w-4"});case"info":return e.jsx(re,{className:"h-4 w-4"});default:return e.jsx($e,{className:"h-4 w-4"})}},Ne=s=>{switch(s){case"active":return"destructive";case"acknowledged":return"secondary";case"resolved":return"default";case"cleared":return"outline";default:return"outline"}},F=s=>{switch(s){case"security":return e.jsx(ie,{className:"h-4 w-4"});case"infrastructure":return e.jsx(Be,{className:"h-4 w-4"});case"clients":return e.jsx(Me,{className:"h-4 w-4"});case"network":return e.jsx(le,{className:"h-4 w-4"});case"performance":return e.jsx(D,{className:"h-4 w-4"});case"configuration":return e.jsx(le,{className:"h-4 w-4"});case"authentication":return e.jsx(ie,{className:"h-4 w-4"});default:return e.jsx(re,{className:"h-4 w-4"})}},J=s=>{const a=new Date(s),l=Date.now()-s;return l<6e4?"Just now":l<36e5?`${Math.floor(l/6e4)}m ago`:l<864e5?`${Math.floor(l/36e5)}h ago`:l<6048e5?`${Math.floor(l/864e5)}d ago`:a.toLocaleDateString()+" "+a.toLocaleTimeString()},z=c.filter(s=>{const a=S==="all"||s.severity===S,x=p==="all"||s.category===p,l=A==="all"||s.status===A,w=o===""||s.message.toLowerCase().includes(o.toLowerCase())||s.description?.toLowerCase().includes(o.toLowerCase())||s.source.toLowerCase().includes(o.toLowerCase());return a&&x&&l&&w}),$=y.filter(s=>{const a=p==="all"||s.category===p,x=o===""||s.message.toLowerCase().includes(o.toLowerCase())||s.description?.toLowerCase().includes(o.toLowerCase())||s.source.toLowerCase().includes(o.toLowerCase());return a&&x}),Ce=["all",...Array.from(new Set(c.map(s=>s.category)))],Se=["all",...Array.from(new Set(y.map(s=>s.category)))],Ae=c.filter(s=>s.severity==="critical"&&s.status==="active").length,be=c.filter(s=>s.severity==="warning"&&s.status==="active").length,Te=c.filter(s=>s.status==="active").length;return c.filter(s=>s.status==="resolved"||s.status==="cleared").length,de?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-8 w-48 bg-muted rounded animate-pulse"}),e.jsx("div",{className:"h-10 w-32 bg-muted rounded animate-pulse"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(s=>e.jsxs(j,{children:[e.jsx(f,{className:"pb-3",children:e.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse"})}),e.jsx(g,{children:e.jsx("div",{className:"h-8 w-16 bg-muted rounded animate-pulse"})})]},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl tracking-tight",children:"Alerts & Events"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time system notifications and event monitoring"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{value:R,onValueChange:je,children:[e.jsxs(T,{className:"w-32",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),e.jsx(E,{})]}),e.jsxs(L,{children:[e.jsx(n,{value:"1h",children:"Last Hour"}),e.jsx(n,{value:"24h",children:"Last 24h"}),e.jsx(n,{value:"7d",children:"Last 7 Days"}),e.jsx(n,{value:"30d",children:"Last 30 Days"})]})]}),e.jsxs(Ee,{onClick:()=>I(!0),variant:"outline",size:"sm",disabled:G,children:[e.jsx(Ie,{className:`mr-2 h-4 w-4 ${G?"animate-spin":""}`}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm",children:"Critical Alerts"}),e.jsx(se,{className:"h-4 w-4 text-destructive"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold text-destructive",children:Ae}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Requires immediate attention"})]})]}),e.jsxs(j,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm",children:"Warnings"}),e.jsx(te,{className:"h-4 w-4 text-warning"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold text-warning",children:be}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Needs review"})]})]}),e.jsxs(j,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm",children:"Active Alerts"}),e.jsx(ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Te}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently open"})]})]}),e.jsxs(j,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm",children:"Total Events"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold",children:y.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"In selected period"})]})]})]}),e.jsxs(Le,{value:C,onValueChange:oe,className:"space-y-4",children:[e.jsxs(ke,{children:[e.jsxs(X,{value:"alerts",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Alerts (",c.length,")"]}),e.jsxs(X,{value:"events",children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Events (",y.length,")"]})]}),e.jsx(j,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(De,{placeholder:"Search...",value:o,onChange:s=>xe(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[C==="alerts"&&e.jsxs(e.Fragment,{children:[e.jsxs(b,{value:S,onValueChange:me,children:[e.jsx(T,{className:"w-32",children:e.jsx(E,{placeholder:"Severity"})}),e.jsxs(L,{children:[e.jsx(n,{value:"all",children:"All Severities"}),e.jsx(n,{value:"critical",children:"Critical"}),e.jsx(n,{value:"warning",children:"Warning"}),e.jsx(n,{value:"info",children:"Info"}),e.jsx(n,{value:"low",children:"Low"})]})]}),e.jsxs(b,{value:A,onValueChange:he,children:[e.jsx(T,{className:"w-32",children:e.jsx(E,{placeholder:"Status"})}),e.jsxs(L,{children:[e.jsx(n,{value:"all",children:"All Status"}),e.jsx(n,{value:"active",children:"Active"}),e.jsx(n,{value:"acknowledged",children:"Acknowledged"}),e.jsx(n,{value:"resolved",children:"Resolved"}),e.jsx(n,{value:"cleared",children:"Cleared"})]})]})]}),e.jsxs(b,{value:p,onValueChange:ue,children:[e.jsx(T,{className:"w-40",children:e.jsx(E,{placeholder:"Category"})}),e.jsx(L,{children:(C==="alerts"?Ce:Se).map(s=>e.jsx(n,{value:s,children:s==="all"?"All Categories":s.charAt(0).toUpperCase()+s.slice(1)},s))})]})]})]})})}),e.jsx(K,{value:"alerts",className:"space-y-4",children:e.jsxs(j,{children:[e.jsxs(f,{children:[e.jsx(v,{children:"Active Alerts"}),e.jsxs(Q,{children:["Showing ",z.length," of ",c.length," alerts"]})]}),e.jsx(g,{children:z.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ze,{className:"mx-auto h-12 w-12 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"mt-4 text-lg",children:"No alerts found"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:o||S!=="all"||A!=="all"||p!=="all"?"Try adjusting your filters":"All systems operating normally"})]}):e.jsx(Y,{className:"h-[600px]",children:e.jsxs(Z,{children:[e.jsx(_,{children:e.jsxs(k,{children:[e.jsx(u,{children:"Severity"}),e.jsx(u,{children:"Category"}),e.jsx(u,{children:"Message"}),e.jsx(u,{children:"Source"}),e.jsx(u,{children:"Status"}),e.jsx(u,{children:"Time"})]})}),e.jsx(ee,{children:z.map(s=>e.jsxs(k,{children:[e.jsx(h,{children:e.jsxs(H,{variant:ye(s.severity),className:"flex items-center gap-1 w-fit",children:[we(s.severity),s.severity]})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[F(s.category),e.jsx("span",{className:"capitalize",children:s.category})]})}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.message}),s.description&&e.jsx("div",{className:"text-sm text-muted-foreground",children:s.description})]})}),e.jsx(h,{children:s.source}),e.jsx(h,{children:e.jsx(H,{variant:Ne(s.status),className:"capitalize",children:s.status})}),e.jsx(h,{className:"text-muted-foreground text-sm",children:J(s.timestamp)})]},s.id))})]})})})]})}),e.jsx(K,{value:"events",className:"space-y-4",children:e.jsxs(j,{children:[e.jsxs(f,{children:[e.jsx(v,{children:"System Events"}),e.jsxs(Q,{children:["Showing ",$.length," of ",y.length," events"]})]}),e.jsx(g,{children:$.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(D,{className:"mx-auto h-12 w-12 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"mt-4 text-lg",children:"No events found"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:o||p!=="all"?"Try adjusting your filters":"No events in selected time range"})]}):e.jsx(Y,{className:"h-[600px]",children:e.jsxs(Z,{children:[e.jsx(_,{children:e.jsxs(k,{children:[e.jsx(u,{children:"Category"}),e.jsx(u,{children:"Type"}),e.jsx(u,{children:"Message"}),e.jsx(u,{children:"Source"}),e.jsx(u,{children:"Time"})]})}),e.jsx(ee,{children:$.map(s=>e.jsxs(k,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[F(s.category),e.jsx("span",{className:"capitalize",children:s.category})]})}),e.jsx(h,{children:e.jsx(H,{variant:"outline",className:"capitalize",children:s.type})}),e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.message}),s.description&&e.jsx("div",{className:"text-sm text-muted-foreground",children:s.description}),s.user&&e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:["User: ",s.user]})]})}),e.jsx(h,{children:s.source}),e.jsx(h,{className:"text-muted-foreground text-sm",children:J(s.timestamp)})]},s.id))})]})})})]})})]}),C==="alerts"&&c.length>0&&e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(v,{children:"Alert Distribution by Category"})}),e.jsx(g,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:Array.from(new Set(c.map(s=>s.category))).map(s=>{const a=c.filter(l=>l.category===s).length,x=Math.round(a/c.length*100);return e.jsxs("div",{className:"p-4 rounded-lg border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[F(s),e.jsx("span",{className:"text-sm font-medium capitalize",children:s})]}),e.jsx("div",{className:"text-2xl font-bold",children:a}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[x,"%"]})]},s)})})})]})]})}export{Je as AlertsEventsEnhanced};
