const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/tablePreferences-D3IEhiLd.js","assets/supabaseClient-VxXemYU-.js","assets/vendor-supabase-UKL6O6TB.js","assets/vendor-react-BQC692LR.js","assets/vendor-ui-CO0mBmim.js"])))=>i.map(i=>d[i]);
import{j as e,ab as Kt,d as qt,e as Zt,P as ht,u as ft,f as Jt,X as es,g as ts}from"./vendor-ui-CO0mBmim.js";import{a as w,c as D}from"./vendor-react-BQC692LR.js";import{a as ne,D as at,B as O,C as $,b as Q,c as H,d as Y,A as Ee,l as be,h as Pe,S as ss,e as I,w as T,t as Se,_ as le,f as it,I as se,L as ee,T as ns,i as as,j as $e,k as Qe,m as De,n as Ie,o as Me,p as ke,q as Oe}from"./index-CrdvL8SR.js";import{T as xt,a as pt,b as We,c as fe,d as gt,e as xe}from"./table-BR47Ry2r.js";import{D as Ke,f as is,a as qe,b as Ze,c as Je,d as et,e as rs}from"./dialog-BqYeg193.js";import{assignmentStorageService as q}from"./assignmentStorage-CCeSXJMB.js";import{L as Te,R as Re,a3 as Nt,x as Fe,J as Ae,j as ls,ai as jt,b as os,S as re,N as vt,f as _e,W as Ce,b0 as cs,h as ds,P as wt,aq as us,aZ as ms,b1 as hs,az as fs,ad as xs,ab as ps,aB as gs,aa as Ns,O as js,A as vs,p as Ye,M as ws,ac as ys,a$ as Ss,a2 as Cs,a0 as As,a_ as ct,a1 as dt}from"./vendor-icons-DmoIqCnf.js";import{C as Es}from"./checkbox-DKtTTixp.js";import{c as yt,R as bs,T as Ps,C as Rs}from"./index-nrHyQllr.js";import{T as Ls}from"./textarea-PnFczYiL.js";import"./vendor-charts-CCS-1Xlq.js";class Ds{async reconcileWLAN(a){console.log(`[WLANReconciliation] Starting reconciliation for WLAN: ${a}`);try{const i=q.getWLANProfileAssignments(a);if(i.length===0)return console.warn(`[WLANReconciliation] No tracked assignments found for WLAN: ${a}`),{wlanId:a,wlanName:a,totalExpected:0,totalActual:0,matched:0,mismatched:0,mismatches:[],timestamp:new Date().toISOString()};const c=i[0]?.wlanName||a,m=[];let d=0,N=0;for(const s of i){const{actualState:n,mismatch:o}=await this.checkProfileState(a,s.profileId,s.expectedState),u={...s,actualState:n,mismatch:o,lastReconciled:new Date().toISOString()};q.saveWLANProfileAssignment(u),m.push(u),o===null?d++:N++}const v=m.filter(s=>s.mismatch!==null),t={wlanId:a,wlanName:c,totalExpected:i.length,totalActual:m.filter(s=>s.actualState==="ASSIGNED").length,matched:d,mismatched:N,mismatches:v,timestamp:new Date().toISOString()};return console.log("[WLANReconciliation] Reconciliation complete:",{wlanId:a,matched:d,mismatched:N}),t}catch(i){throw console.error(`[WLANReconciliation] Reconciliation failed for WLAN ${a}:`,i),i}}async checkProfileState(a,i,c){try{const m=await ne.getProfileById(i);if(!m)return{actualState:"UNKNOWN",mismatch:"PROFILE_DELETED"};const N=m.services?.includes(a)||!1?"ASSIGNED":"NOT_ASSIGNED";let v=null;return c==="ASSIGNED"&&N==="NOT_ASSIGNED"?v="MISSING_ASSIGNMENT":c==="NOT_ASSIGNED"&&N==="ASSIGNED"&&(v="UNEXPECTED_ASSIGNMENT"),{actualState:N,mismatch:v}}catch(m){return console.warn(`[WLANReconciliation] Error checking profile ${i}:`,m),{actualState:"UNKNOWN",mismatch:"PROFILE_DELETED"}}}async reconcileAllWLANs(){console.log("[WLANReconciliation] Starting reconciliation for all tracked WLANs");const a=q.getAllTrackedWLANs();console.log(`[WLANReconciliation] Found ${a.length} tracked WLANs`);const i=[];for(const c of a)try{const m=await this.reconcileWLAN(c);i.push(m)}catch(m){console.error(`[WLANReconciliation] Failed to reconcile WLAN ${c}:`,m)}return console.log("[WLANReconciliation] All reconciliations complete:",{total:i.length,withMismatches:i.filter(c=>c.mismatched>0).length}),i}generateRemediationActions(a){console.log(`[WLANReconciliation] Generating remediation actions for ${a.length} mismatches`);const i=[];for(const c of a){if(!c.mismatch)continue;let m,d;switch(c.mismatch){case"MISSING_ASSIGNMENT":m="ADD_ASSIGNMENT",d="Profile expected to have WLAN but doesn't";break;case"UNEXPECTED_ASSIGNMENT":m="REMOVE_ASSIGNMENT",d="Profile has WLAN but shouldn't";break;case"SYNC_FAILED":m="RESYNC_PROFILE",d="Profile sync failed";break;case"PROFILE_DELETED":continue;case"PROFILE_MOVED":m="RESYNC_PROFILE",d="Profile moved to different device group";break;default:continue}i.push({type:m,wlanId:c.wlanId,wlanName:c.wlanName,profileId:c.profileId,profileName:c.profileName,siteId:c.siteId,reason:d,mismatchReason:c.mismatch})}return console.log(`[WLANReconciliation] Generated ${i.length} remediation actions`),i}async executeRemediation(a){console.log(`[WLANReconciliation] Executing ${a.length} remediation actions`);const i=[];let c=0,m=0;for(const d of a)try{await this.executeRemediationAction(d),i.push({action:d,success:!0}),c++}catch(N){const v=N instanceof Error?N.message:"Unknown error";console.error("[WLANReconciliation] Remediation action failed:",d,N),i.push({action:d,success:!1,error:v}),m++}return console.log("[WLANReconciliation] Remediation execution complete:",{successful:c,failed:m}),{successful:c,failed:m,results:i}}async executeRemediationAction(a){switch(console.log("[WLANReconciliation] Executing remediation action:",a),a.type){case"ADD_ASSIGNMENT":await ne.assignServiceToProfile(a.wlanId,a.profileId),q.updateProfileAssignmentActualState(a.wlanId,a.profileId,"ASSIGNED",null),q.updateProfileAssignmentSyncStatus(a.wlanId,a.profileId,"PENDING");break;case"REMOVE_ASSIGNMENT":throw console.warn("[WLANReconciliation] REMOVE_ASSIGNMENT not yet implemented"),new Error("Remove assignment not yet implemented");case"RESYNC_PROFILE":await ne.syncProfile(a.profileId),q.updateProfileAssignmentSyncStatus(a.wlanId,a.profileId,"SYNCED");break;default:throw new Error(`Unknown remediation action type: ${a.type}`)}console.log("[WLANReconciliation] Remediation action executed successfully:",a.type)}async getReconciliationSummary(){const a=await this.reconcileAllWLANs(),i=a.reduce((N,v)=>N+v.totalExpected,0),c=a.reduce((N,v)=>N+v.matched,0),m=a.reduce((N,v)=>N+v.mismatched,0),d=i>0?m/i*100:0;return{totalWLANs:a.length,totalAssignments:i,matched:c,mismatched:m,mismatchRate:d}}}const He=new Ds;function Is({open:r,onOpenChange:a,wlanId:i,wlanName:c}){const[m,d]=w.useState(!1),[N,v]=w.useState(null),[t,s]=w.useState(!1),[n,o]=w.useState([]),u=async()=>{d(!0),v(null);try{const x=await He.reconcileWLAN(i);if(v(x),x.mismatched===0)T.success("Reconciliation Complete",{description:`All ${x.totalExpected} profile assignments match expectations`});else{T.warning("Mismatches Detected",{description:`Found ${x.mismatched} mismatch(es) that need attention`});const h=He.generateRemediationActions(x.mismatches);o(h)}}catch(x){console.error("[ReconciliationDialog] Reconciliation failed:",x),T.error("Reconciliation Failed",{description:x instanceof Error?x.message:"Unknown error"})}finally{d(!1)}},j=async()=>{if(n.length!==0){s(!0);try{const{successful:x,failed:h}=await He.executeRemediation(n);h===0?(T.success("Remediation Complete",{description:`Fixed ${x} mismatch(es) successfully`}),await u()):(T.warning("Remediation Partially Complete",{description:`Fixed ${x}, failed ${h}`}),await u())}catch(x){console.error("[ReconciliationDialog] Remediation failed:",x),T.error("Remediation Failed",{description:x instanceof Error?x.message:"Unknown error"})}finally{s(!1)}}},f=x=>{switch(x){case"MISSING_ASSIGNMENT":return e.jsx(I,{variant:"destructive",className:"text-xs",children:"Missing"});case"UNEXPECTED_ASSIGNMENT":return e.jsx(I,{variant:"outline",className:"text-xs",children:"Unexpected"});case"SYNC_FAILED":return e.jsx(I,{variant:"secondary",className:"text-xs",children:"Sync Failed"});case"PROFILE_DELETED":return e.jsx(I,{variant:"outline",className:"text-xs",children:"Deleted"});default:return e.jsx(I,{variant:"secondary",className:"text-xs",children:x})}};return e.jsx(at,{isOpen:r,onClose:()=>a(!1),title:`WLAN Reconciliation - ${c}`,description:"Compare expected vs actual WLAN assignments and fix mismatches",width:"xl",children:e.jsxs("div",{className:"space-y-6",children:[!N&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(O,{onClick:u,disabled:m,size:"lg",children:m?e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"h-4 w-4 mr-2 animate-spin"}),"Running Reconciliation..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Run Reconciliation"]})}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"This will check all profile assignments against actual API state"})]}),m&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Te,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Checking profile assignments..."})]}),N&&!m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs($,{children:[e.jsx(Q,{className:"pb-3",children:e.jsx(H,{className:"text-sm text-muted-foreground",children:"Expected"})}),e.jsx(Y,{children:e.jsx("div",{className:"text-2xl font-bold",children:N.totalExpected})})]}),e.jsxs($,{children:[e.jsx(Q,{className:"pb-3",children:e.jsx(H,{className:"text-sm text-muted-foreground",children:"Actual"})}),e.jsx(Y,{children:e.jsx("div",{className:"text-2xl font-bold",children:N.totalActual})})]}),e.jsxs($,{children:[e.jsx(Q,{className:"pb-3",children:e.jsx(H,{className:"text-sm text-green-600",children:"Matched"})}),e.jsx(Y,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:N.matched})})]}),e.jsxs($,{children:[e.jsx(Q,{className:"pb-3",children:e.jsx(H,{className:"text-sm text-destructive",children:"Mismatched"})}),e.jsx(Y,{children:e.jsx("div",{className:"text-2xl font-bold text-destructive",children:N.mismatched})})]})]}),N.mismatched===0?e.jsxs(Ee,{className:"border-green-600/20 bg-green-50 dark:bg-green-900/10",children:[e.jsx(Nt,{className:"h-4 w-4 text-green-600"}),e.jsx(be,{className:"text-green-800 dark:text-green-200",children:"All profile assignments match expectations. No action needed."})]}):e.jsxs(Ee,{variant:"destructive",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsxs(be,{children:["Found ",N.mismatched," mismatch(es) that need attention.",n.length>0&&e.jsxs("span",{className:"ml-1",children:[n.length," remediation action(s) available."]})]})]}),N.mismatches.length>0&&e.jsxs($,{children:[e.jsxs(Q,{children:[e.jsxs(H,{className:"text-base flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"Mismatches Detected"]}),e.jsx(Pe,{children:"Profiles with incorrect assignment state"})]}),e.jsx(Y,{children:e.jsx(ss,{className:"max-h-[300px]",children:e.jsxs(xt,{children:[e.jsx(pt,{children:e.jsxs(We,{children:[e.jsx(fe,{children:"Profile"}),e.jsx(fe,{children:"Expected"}),e.jsx(fe,{children:"Actual"}),e.jsx(fe,{children:"Reason"})]})}),e.jsx(gt,{children:N.mismatches.map(x=>e.jsxs(We,{children:[e.jsx(xe,{className:"font-medium",children:x.profileName}),e.jsx(xe,{children:e.jsx(I,{variant:x.expectedState==="ASSIGNED"?"default":"outline",children:x.expectedState})}),e.jsx(xe,{children:e.jsx(I,{variant:x.actualState==="ASSIGNED"?"default":"outline",children:x.actualState})}),e.jsx(xe,{children:x.mismatch&&f(x.mismatch)})]},x.profileId))})]})})})]}),n.length>0&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[n.length," remediation action(s) ready"]}),e.jsx(O,{onClick:j,disabled:t,variant:"default",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"h-4 w-4 mr-2 animate-spin"}),"Fixing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Fix All Mismatches"]})})]}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsxs(O,{variant:"outline",onClick:u,disabled:m,size:"sm",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Re-run Reconciliation"]})})]})]})})}var Ms=Object.defineProperty,Ve=Object.getOwnPropertySymbols,St=Object.prototype.hasOwnProperty,Ct=Object.prototype.propertyIsEnumerable,ut=(r,a,i)=>a in r?Ms(r,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[a]=i,tt=(r,a)=>{for(var i in a||(a={}))St.call(a,i)&&ut(r,i,a[i]);if(Ve)for(var i of Ve(a))Ct.call(a,i)&&ut(r,i,a[i]);return r},st=(r,a)=>{var i={};for(var c in r)St.call(r,c)&&a.indexOf(c)<0&&(i[c]=r[c]);if(r!=null&&Ve)for(var c of Ve(r))a.indexOf(c)<0&&Ct.call(r,c)&&(i[c]=r[c]);return i};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var oe;(r=>{const a=class L{constructor(t,s,n,o){if(this.version=t,this.errorCorrectionLevel=s,this.modules=[],this.isFunction=[],t<L.MIN_VERSION||t>L.MAX_VERSION)throw new RangeError("Version value out of range");if(o<-1||o>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let u=[];for(let f=0;f<this.size;f++)u.push(!1);for(let f=0;f<this.size;f++)this.modules.push(u.slice()),this.isFunction.push(u.slice());this.drawFunctionPatterns();const j=this.addEccAndInterleave(n);if(this.drawCodewords(j),o==-1){let f=1e9;for(let x=0;x<8;x++){this.applyMask(x),this.drawFormatBits(x);const h=this.getPenaltyScore();h<f&&(o=x,f=h),this.applyMask(x)}}m(0<=o&&o<=7),this.mask=o,this.applyMask(o),this.drawFormatBits(o),this.isFunction=[]}static encodeText(t,s){const n=r.QrSegment.makeSegments(t);return L.encodeSegments(n,s)}static encodeBinary(t,s){const n=r.QrSegment.makeBytes(t);return L.encodeSegments([n],s)}static encodeSegments(t,s,n=1,o=40,u=-1,j=!0){if(!(L.MIN_VERSION<=n&&n<=o&&o<=L.MAX_VERSION)||u<-1||u>7)throw new RangeError("Invalid value");let f,x;for(f=n;;f++){const A=L.getNumDataCodewords(f,s)*8,R=N.getTotalBits(t,f);if(R<=A){x=R;break}if(f>=o)throw new RangeError("Data too long")}for(const A of[L.Ecc.MEDIUM,L.Ecc.QUARTILE,L.Ecc.HIGH])j&&x<=L.getNumDataCodewords(f,A)*8&&(s=A);let h=[];for(const A of t){i(A.mode.modeBits,4,h),i(A.numChars,A.mode.numCharCountBits(f),h);for(const R of A.getData())h.push(R)}m(h.length==x);const E=L.getNumDataCodewords(f,s)*8;m(h.length<=E),i(0,Math.min(4,E-h.length),h),i(0,(8-h.length%8)%8,h),m(h.length%8==0);for(let A=236;h.length<E;A^=253)i(A,8,h);let C=[];for(;C.length*8<h.length;)C.push(0);return h.forEach((A,R)=>C[R>>>3]|=A<<7-(R&7)),new L(f,s,C,u)}getModule(t,s){return 0<=t&&t<this.size&&0<=s&&s<this.size&&this.modules[s][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let n=0;n<this.size;n++)this.setFunctionModule(6,n,n%2==0),this.setFunctionModule(n,6,n%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),s=t.length;for(let n=0;n<s;n++)for(let o=0;o<s;o++)n==0&&o==0||n==0&&o==s-1||n==s-1&&o==0||this.drawAlignmentPattern(t[n],t[o]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const s=this.errorCorrectionLevel.formatBits<<3|t;let n=s;for(let u=0;u<10;u++)n=n<<1^(n>>>9)*1335;const o=(s<<10|n)^21522;m(o>>>15==0);for(let u=0;u<=5;u++)this.setFunctionModule(8,u,c(o,u));this.setFunctionModule(8,7,c(o,6)),this.setFunctionModule(8,8,c(o,7)),this.setFunctionModule(7,8,c(o,8));for(let u=9;u<15;u++)this.setFunctionModule(14-u,8,c(o,u));for(let u=0;u<8;u++)this.setFunctionModule(this.size-1-u,8,c(o,u));for(let u=8;u<15;u++)this.setFunctionModule(8,this.size-15+u,c(o,u));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let n=0;n<12;n++)t=t<<1^(t>>>11)*7973;const s=this.version<<12|t;m(s>>>18==0);for(let n=0;n<18;n++){const o=c(s,n),u=this.size-11+n%3,j=Math.floor(n/3);this.setFunctionModule(u,j,o),this.setFunctionModule(j,u,o)}}drawFinderPattern(t,s){for(let n=-4;n<=4;n++)for(let o=-4;o<=4;o++){const u=Math.max(Math.abs(o),Math.abs(n)),j=t+o,f=s+n;0<=j&&j<this.size&&0<=f&&f<this.size&&this.setFunctionModule(j,f,u!=2&&u!=4)}}drawAlignmentPattern(t,s){for(let n=-2;n<=2;n++)for(let o=-2;o<=2;o++)this.setFunctionModule(t+o,s+n,Math.max(Math.abs(o),Math.abs(n))!=1)}setFunctionModule(t,s,n){this.modules[s][t]=n,this.isFunction[s][t]=!0}addEccAndInterleave(t){const s=this.version,n=this.errorCorrectionLevel;if(t.length!=L.getNumDataCodewords(s,n))throw new RangeError("Invalid argument");const o=L.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][s],u=L.ECC_CODEWORDS_PER_BLOCK[n.ordinal][s],j=Math.floor(L.getNumRawDataModules(s)/8),f=o-j%o,x=Math.floor(j/o);let h=[];const E=L.reedSolomonComputeDivisor(u);for(let A=0,R=0;A<o;A++){let M=t.slice(R,R+x-u+(A<f?0:1));R+=M.length;const G=L.reedSolomonComputeRemainder(M,E);A<f&&M.push(0),h.push(M.concat(G))}let C=[];for(let A=0;A<h[0].length;A++)h.forEach((R,M)=>{(A!=x-u||M>=f)&&C.push(R[A])});return m(C.length==j),C}drawCodewords(t){if(t.length!=Math.floor(L.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let s=0;for(let n=this.size-1;n>=1;n-=2){n==6&&(n=5);for(let o=0;o<this.size;o++)for(let u=0;u<2;u++){const j=n-u,x=(n+1&2)==0?this.size-1-o:o;!this.isFunction[x][j]&&s<t.length*8&&(this.modules[x][j]=c(t[s>>>3],7-(s&7)),s++)}}m(s==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let s=0;s<this.size;s++)for(let n=0;n<this.size;n++){let o;switch(t){case 0:o=(n+s)%2==0;break;case 1:o=s%2==0;break;case 2:o=n%3==0;break;case 3:o=(n+s)%3==0;break;case 4:o=(Math.floor(n/3)+Math.floor(s/2))%2==0;break;case 5:o=n*s%2+n*s%3==0;break;case 6:o=(n*s%2+n*s%3)%2==0;break;case 7:o=((n+s)%2+n*s%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[s][n]&&o&&(this.modules[s][n]=!this.modules[s][n])}}getPenaltyScore(){let t=0;for(let u=0;u<this.size;u++){let j=!1,f=0,x=[0,0,0,0,0,0,0];for(let h=0;h<this.size;h++)this.modules[u][h]==j?(f++,f==5?t+=L.PENALTY_N1:f>5&&t++):(this.finderPenaltyAddHistory(f,x),j||(t+=this.finderPenaltyCountPatterns(x)*L.PENALTY_N3),j=this.modules[u][h],f=1);t+=this.finderPenaltyTerminateAndCount(j,f,x)*L.PENALTY_N3}for(let u=0;u<this.size;u++){let j=!1,f=0,x=[0,0,0,0,0,0,0];for(let h=0;h<this.size;h++)this.modules[h][u]==j?(f++,f==5?t+=L.PENALTY_N1:f>5&&t++):(this.finderPenaltyAddHistory(f,x),j||(t+=this.finderPenaltyCountPatterns(x)*L.PENALTY_N3),j=this.modules[h][u],f=1);t+=this.finderPenaltyTerminateAndCount(j,f,x)*L.PENALTY_N3}for(let u=0;u<this.size-1;u++)for(let j=0;j<this.size-1;j++){const f=this.modules[u][j];f==this.modules[u][j+1]&&f==this.modules[u+1][j]&&f==this.modules[u+1][j+1]&&(t+=L.PENALTY_N2)}let s=0;for(const u of this.modules)s=u.reduce((j,f)=>j+(f?1:0),s);const n=this.size*this.size,o=Math.ceil(Math.abs(s*20-n*10)/n)-1;return m(0<=o&&o<=9),t+=o*L.PENALTY_N4,m(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{const t=Math.floor(this.version/7)+2,s=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let n=[6];for(let o=this.size-7;n.length<t;o-=s)n.splice(1,0,o);return n}}static getNumRawDataModules(t){if(t<L.MIN_VERSION||t>L.MAX_VERSION)throw new RangeError("Version number out of range");let s=(16*t+128)*t+64;if(t>=2){const n=Math.floor(t/7)+2;s-=(25*n-10)*n-55,t>=7&&(s-=36)}return m(208<=s&&s<=29648),s}static getNumDataCodewords(t,s){return Math.floor(L.getNumRawDataModules(t)/8)-L.ECC_CODEWORDS_PER_BLOCK[s.ordinal][t]*L.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let s=[];for(let o=0;o<t-1;o++)s.push(0);s.push(1);let n=1;for(let o=0;o<t;o++){for(let u=0;u<s.length;u++)s[u]=L.reedSolomonMultiply(s[u],n),u+1<s.length&&(s[u]^=s[u+1]);n=L.reedSolomonMultiply(n,2)}return s}static reedSolomonComputeRemainder(t,s){let n=s.map(o=>0);for(const o of t){const u=o^n.shift();n.push(0),s.forEach((j,f)=>n[f]^=L.reedSolomonMultiply(j,u))}return n}static reedSolomonMultiply(t,s){if(t>>>8||s>>>8)throw new RangeError("Byte out of range");let n=0;for(let o=7;o>=0;o--)n=n<<1^(n>>>7)*285,n^=(s>>>o&1)*t;return m(n>>>8==0),n}finderPenaltyCountPatterns(t){const s=t[1];m(s<=this.size*3);const n=s>0&&t[2]==s&&t[3]==s*3&&t[4]==s&&t[5]==s;return(n&&t[0]>=s*4&&t[6]>=s?1:0)+(n&&t[6]>=s*4&&t[0]>=s?1:0)}finderPenaltyTerminateAndCount(t,s,n){return t&&(this.finderPenaltyAddHistory(s,n),s=0),s+=this.size,this.finderPenaltyAddHistory(s,n),this.finderPenaltyCountPatterns(n)}finderPenaltyAddHistory(t,s){s[0]==0&&(t+=this.size),s.pop(),s.unshift(t)}};a.MIN_VERSION=1,a.MAX_VERSION=40,a.PENALTY_N1=3,a.PENALTY_N2=3,a.PENALTY_N3=40,a.PENALTY_N4=10,a.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],a.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],r.QrCode=a;function i(v,t,s){if(t<0||t>31||v>>>t)throw new RangeError("Value out of range");for(let n=t-1;n>=0;n--)s.push(v>>>n&1)}function c(v,t){return(v>>>t&1)!=0}function m(v){if(!v)throw new Error("Assertion error")}const d=class W{constructor(t,s,n){if(this.mode=t,this.numChars=s,this.bitData=n,s<0)throw new RangeError("Invalid argument");this.bitData=n.slice()}static makeBytes(t){let s=[];for(const n of t)i(n,8,s);return new W(W.Mode.BYTE,t.length,s)}static makeNumeric(t){if(!W.isNumeric(t))throw new RangeError("String contains non-numeric characters");let s=[];for(let n=0;n<t.length;){const o=Math.min(t.length-n,3);i(parseInt(t.substring(n,n+o),10),o*3+1,s),n+=o}return new W(W.Mode.NUMERIC,t.length,s)}static makeAlphanumeric(t){if(!W.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let s=[],n;for(n=0;n+2<=t.length;n+=2){let o=W.ALPHANUMERIC_CHARSET.indexOf(t.charAt(n))*45;o+=W.ALPHANUMERIC_CHARSET.indexOf(t.charAt(n+1)),i(o,11,s)}return n<t.length&&i(W.ALPHANUMERIC_CHARSET.indexOf(t.charAt(n)),6,s),new W(W.Mode.ALPHANUMERIC,t.length,s)}static makeSegments(t){return t==""?[]:W.isNumeric(t)?[W.makeNumeric(t)]:W.isAlphanumeric(t)?[W.makeAlphanumeric(t)]:[W.makeBytes(W.toUtf8ByteArray(t))]}static makeEci(t){let s=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)i(t,8,s);else if(t<16384)i(2,2,s),i(t,14,s);else if(t<1e6)i(6,3,s),i(t,21,s);else throw new RangeError("ECI assignment value out of range");return new W(W.Mode.ECI,0,s)}static isNumeric(t){return W.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return W.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,s){let n=0;for(const o of t){const u=o.mode.numCharCountBits(s);if(o.numChars>=1<<u)return 1/0;n+=4+u+o.bitData.length}return n}static toUtf8ByteArray(t){t=encodeURI(t);let s=[];for(let n=0;n<t.length;n++)t.charAt(n)!="%"?s.push(t.charCodeAt(n)):(s.push(parseInt(t.substring(n+1,n+3),16)),n+=2);return s}};d.NUMERIC_REGEX=/^[0-9]*$/,d.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,d.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let N=d;r.QrSegment=d})(oe||(oe={}));(r=>{(a=>{const i=class{constructor(m,d){this.ordinal=m,this.formatBits=d}};i.LOW=new i(0,1),i.MEDIUM=new i(1,0),i.QUARTILE=new i(2,3),i.HIGH=new i(3,2),a.Ecc=i})(r.QrCode||(r.QrCode={}))})(oe||(oe={}));(r=>{(a=>{const i=class{constructor(m,d){this.modeBits=m,this.numBitsCharCount=d}numCharCountBits(m){return this.numBitsCharCount[Math.floor((m+7)/17)]}};i.NUMERIC=new i(1,[10,12,14]),i.ALPHANUMERIC=new i(2,[9,11,13]),i.BYTE=new i(4,[8,16,16]),i.KANJI=new i(8,[8,10,12]),i.ECI=new i(7,[0,0,0]),a.Mode=i})(r.QrSegment||(r.QrSegment={}))})(oe||(oe={}));var pe=oe;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var ks={L:pe.QrCode.Ecc.LOW,M:pe.QrCode.Ecc.MEDIUM,Q:pe.QrCode.Ecc.QUARTILE,H:pe.QrCode.Ecc.HIGH},At=128,Et="L",bt="#FFFFFF",Pt="#000000",Rt=!1,Lt=1,Os=4,Ts=0,_s=.1;function Dt(r,a=0){const i=[];return r.forEach(function(c,m){let d=null;c.forEach(function(N,v){if(!N&&d!==null){i.push(`M${d+a} ${m+a}h${v-d}v1H${d+a}z`),d=null;return}if(v===c.length-1){if(!N)return;d===null?i.push(`M${v+a},${m+a} h1v1H${v+a}z`):i.push(`M${d+a},${m+a} h${v+1-d}v1H${d+a}z`);return}N&&d===null&&(d=v)})}),i.join("")}function It(r,a){return r.slice().map((i,c)=>c<a.y||c>=a.y+a.h?i:i.map((m,d)=>d<a.x||d>=a.x+a.w?m:!1))}function Ws(r,a,i,c){if(c==null)return null;const m=r.length+i*2,d=Math.floor(a*_s),N=m/a,v=(c.width||d)*N,t=(c.height||d)*N,s=c.x==null?r.length/2-v/2:c.x*N,n=c.y==null?r.length/2-t/2:c.y*N,o=c.opacity==null?1:c.opacity;let u=null;if(c.excavate){let f=Math.floor(s),x=Math.floor(n),h=Math.ceil(v+s-f),E=Math.ceil(t+n-x);u={x:f,y:x,w:h,h:E}}const j=c.crossOrigin;return{x:s,y:n,h:t,w:v,excavation:u,opacity:o,crossOrigin:j}}function Fs(r,a){return a!=null?Math.max(Math.floor(a),0):r?Os:Ts}function Mt({value:r,level:a,minVersion:i,includeMargin:c,marginSize:m,imageSettings:d,size:N,boostLevel:v}){let t=D.useMemo(()=>{const f=(Array.isArray(r)?r:[r]).reduce((x,h)=>(x.push(...pe.QrSegment.makeSegments(h)),x),[]);return pe.QrCode.encodeSegments(f,ks[a],i,void 0,void 0,v)},[r,a,i,v]);const{cells:s,margin:n,numCells:o,calculatedImageSettings:u}=D.useMemo(()=>{let j=t.getModules();const f=Fs(c,m),x=j.length+f*2,h=Ws(j,N,f,d);return{cells:j,margin:f,numCells:x,calculatedImageSettings:h}},[t,N,d,c,m]);return{qrcode:t,margin:n,cells:s,numCells:o,calculatedImageSettings:u}}var Vs=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),zs=D.forwardRef(function(a,i){const c=a,{value:m,size:d=At,level:N=Et,bgColor:v=bt,fgColor:t=Pt,includeMargin:s=Rt,minVersion:n=Lt,boostLevel:o,marginSize:u,imageSettings:j}=c,x=st(c,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:h}=x,E=st(x,["style"]),C=j?.src,A=D.useRef(null),R=D.useRef(null),M=D.useCallback(V=>{A.current=V,typeof i=="function"?i(V):i&&(i.current=V)},[i]),[G,U]=D.useState(!1),{margin:F,cells:Z,numCells:S,calculatedImageSettings:p}=Mt({value:m,level:N,minVersion:n,boostLevel:o,includeMargin:s,marginSize:u,imageSettings:j,size:d});D.useEffect(()=>{if(A.current!=null){const V=A.current,P=V.getContext("2d");if(!P)return;let B=Z;const X=R.current,K=p!=null&&X!==null&&X.complete&&X.naturalHeight!==0&&X.naturalWidth!==0;K&&p.excavation!=null&&(B=It(Z,p.excavation));const ce=window.devicePixelRatio||1;V.height=V.width=d*ce;const de=d/S*ce;P.scale(de,de),P.fillStyle=v,P.fillRect(0,0,S,S),P.fillStyle=t,Vs?P.fill(new Path2D(Dt(B,F))):Z.forEach(function(ge,Ne){ge.forEach(function(je,ve){je&&P.fillRect(ve+F,Ne+F,1,1)})}),p&&(P.globalAlpha=p.opacity),K&&P.drawImage(X,p.x+F,p.y+F,p.w,p.h)}}),D.useEffect(()=>{U(!1)},[C]);const _=tt({height:d,width:d},h);let J=null;return C!=null&&(J=D.createElement("img",{src:C,key:C,style:{display:"none"},onLoad:()=>{U(!0)},ref:R,crossOrigin:p?.crossOrigin})),D.createElement(D.Fragment,null,D.createElement("canvas",tt({style:_,height:d,width:d,ref:M,role:"img"},E)),J)});zs.displayName="QRCodeCanvas";var kt=D.forwardRef(function(a,i){const c=a,{value:m,size:d=At,level:N=Et,bgColor:v=bt,fgColor:t=Pt,includeMargin:s=Rt,minVersion:n=Lt,boostLevel:o,title:u,marginSize:j,imageSettings:f}=c,x=st(c,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:h,cells:E,numCells:C,calculatedImageSettings:A}=Mt({value:m,level:N,minVersion:n,boostLevel:o,includeMargin:s,marginSize:j,imageSettings:f,size:d});let R=E,M=null;f!=null&&A!=null&&(A.excavation!=null&&(R=It(E,A.excavation)),M=D.createElement("image",{href:f.src,height:A.h,width:A.w,x:A.x+h,y:A.y+h,preserveAspectRatio:"none",opacity:A.opacity,crossOrigin:A.crossOrigin}));const G=Dt(R,h);return D.createElement("svg",tt({height:d,width:d,viewBox:`0 0 ${C} ${C}`,ref:i,role:"img"},x),!!u&&D.createElement("title",null,u),D.createElement("path",{fill:v,d:`M0,0 h${C}v${C}H0z`,shapeRendering:"crispEdges"}),D.createElement("path",{fill:t,d:G,shapeRendering:"crispEdges"}),M)});kt.displayName="QRCodeSVG";function Gs({open:r,onOpenChange:a,wlan:i}){const c=w.useRef(null),d=(()=>{const t=i.security?.toLowerCase()||"open";let s="nopass";t.includes("wpa3")||t.includes("wpa2")||t.includes("wpa")?s="WPA":t.includes("wep")&&(s="WEP");const n=i.ssid,o=i.passphrase||"",u=i.hidden?"true":"false",j=n.replace(/([\\;,":])/g,"\\$1"),f=o.replace(/([\\;,":])/g,"\\$1");return s==="nopass"?`WIFI:T:nopass;S:${j};H:${u};;`:`WIFI:T:${s};S:${j};P:${f};H:${u};;`})(),N=()=>{try{const t=c.current?.querySelector("svg");if(!t)throw new Error("QR code not found");const s=new XMLSerializer().serializeToString(t),n=document.createElement("canvas"),o=n.getContext("2d"),u=new Image;u.onload=()=>{n.width=u.width+80,n.height=u.height+80,o&&(o.fillStyle="#ffffff",o.fillRect(0,0,n.width,n.height),o.drawImage(u,40,40),n.toBlob(f=>{if(f){const x=URL.createObjectURL(f),h=document.createElement("a");h.href=x,h.download=`wifi-${i.ssid.replace(/[^a-zA-Z0-9]/g,"_")}.png`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(x),T.success("QR Code Downloaded",{description:`Saved as ${h.download}`})}},"image/png"))},u.src="data:image/svg+xml;base64,"+btoa(s)}catch(t){console.error("Error downloading QR code:",t),T.error("Failed to download QR code",{description:t instanceof Error?t.message:"Unknown error"})}},v=()=>{const t=i.security?.toLowerCase()||"unknown";return t.includes("open")?e.jsxs(I,{variant:"outline",className:"gap-1",children:[e.jsx(re,{className:"h-3 w-3"})," Open"]}):t.includes("wpa3")?e.jsxs(I,{variant:"default",className:"gap-1",children:[e.jsx(re,{className:"h-3 w-3"})," WPA3"]}):t.includes("wpa2-enterprise")||t.includes("enterprise")?e.jsxs(I,{variant:"secondary",className:"gap-1",children:[e.jsx(re,{className:"h-3 w-3"})," WPA2-Enterprise"]}):t.includes("wpa2")?e.jsxs(I,{variant:"secondary",className:"gap-1",children:[e.jsx(re,{className:"h-3 w-3"})," WPA2"]}):e.jsx(I,{variant:"outline",children:i.security||"Unknown"})};return e.jsx(at,{isOpen:r,onClose:()=>a(!1),title:"WiFi QR Code",description:"Scan with your phone to connect to this network",width:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[e.jsx("div",{className:"font-medium text-lg",children:i.ssid}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[v(),i.band&&e.jsxs(I,{variant:"outline",className:"gap-1",children:[e.jsx(jt,{className:"h-3 w-3"}),i.band]}),i.hidden&&e.jsx(I,{variant:"outline",className:"text-xs",children:"Hidden"})]})]}),e.jsx("div",{ref:c,className:"flex justify-center p-6 bg-white rounded-lg",children:e.jsx(kt,{value:d,size:256,level:"M",includeMargin:!1})}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("p",{className:"font-medium",children:"How to use:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Open your phone's camera app"}),e.jsx("li",{children:"Point it at the QR code above"}),e.jsx("li",{children:"Tap the WiFi notification that appears"}),e.jsx("li",{children:"Your device will connect automatically"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx(O,{variant:"outline",onClick:()=>a(!1),className:"flex-1",children:"Close"}),e.jsxs(O,{onClick:N,className:"gap-2 flex-1",children:[e.jsx(os,{className:"h-4 w-4"}),"Download QR Code"]})]})]})})}class Bs{getWLANDeploymentStatus(a){try{const i=q.getWLANSiteAssignments(a),c=q.getWLANProfileAssignments(a);if(i.length===0)return"NOT_DEPLOYED";const m=c.filter(d=>d.syncStatus==="FAILED"||d.mismatch!==null);return m.length>0&&m.length<c.length?"PARTIALLY_DEPLOYED":(c.length>0,"DEPLOYED")}catch(i){return console.error("[WLANDeploymentStatus] Error getting deployment status:",i),"UNKNOWN"}}getWLANWithStatus(a){const i=this.getWLANDeploymentStatus(a.id),c=q.getWLANSiteAssignments(a.id),m=q.getWLANProfileAssignments(a.id),d=c.length,N=m.filter(s=>s.expectedState==="ASSIGNED").length,v=m.filter(s=>s.mismatch!==null).length,t=m.length>0?m.map(s=>s.lastReconciled).filter(Boolean).sort().reverse()[0]:void 0;return{...a,deploymentStatus:i,totalSites:d,totalProfiles:N,mismatchCount:v,lastReconciled:t}}async createSiteInventory(a,i,c,m,d=[]){console.log("[WLANDeploymentStatus] Creating site inventory for",i);const N=c.map(t=>{const n=q.getWLANProfileAssignments(t.id).filter(x=>x.siteId===a&&x.expectedState==="ASSIGNED").length,o=m.filter(x=>x.wlans?.some(h=>h.id===t.id)).length,u=this.getWLANDeploymentStatus(t.id);let j=null;return n===0?j="SITE_ASSIGNMENT_MISSING":n!==o&&(o===0?j="PROVISIONING_FAILED":j="MISSING_ASSIGNMENT"),!d.some(x=>x.id===t.id||x.ssid===t.ssid)&&n>0&&(j="INTENDED_ONLY"),{wlan:t,expectedProfiles:n,actualProfiles:o,deploymentStatus:u,mismatchReason:j}}),v=N.filter(t=>t.mismatchReason!==null).map(t=>({wlanId:t.wlan.id,wlanName:t.wlan.ssid||t.wlan.name||t.wlan.id,reason:t.mismatchReason,severity:this.getMismatchSeverity(t.mismatchReason)}));return d.forEach(t=>{c.some(n=>n.id===t.id||n.ssid===t.ssid)||v.push({wlanId:t.id,wlanName:t.ssid,reason:"OBSERVED_ONLY",severity:"warning"})}),{siteId:a,siteName:i,intendedWLANs:N,observedWLANs:d,mismatches:v,timestamp:new Date().toISOString()}}getMismatchSeverity(a){switch(a){case"WLAN_NOT_DEPLOYED":case"PROVISIONING_FAILED":case"PROFILE_DELETED":return"error";case"SITE_ASSIGNMENT_MISSING":case"MISSING_ASSIGNMENT":case"PROFILE_MAPPING_MISSING":case"SYNC_FAILED":return"warning";case"OBSERVED_ONLY":case"INTENDED_ONLY":case"CACHE_STALE":case"UNEXPECTED_ASSIGNMENT":case"PROFILE_MOVED":return"info";default:return"info"}}getMismatchDescription(a){switch(a){case"MISSING_ASSIGNMENT":return"Expected assignment not found on some profiles";case"UNEXPECTED_ASSIGNMENT":return"WLAN found on profiles where not expected";case"PROFILE_DELETED":return"Target profile no longer exists";case"PROFILE_MOVED":return"Profile moved to different device group";case"SYNC_FAILED":return"Assignment created but sync to device failed";case"WLAN_NOT_DEPLOYED":return"WLAN has no deployment assignments";case"SITE_ASSIGNMENT_MISSING":return"Site has no assignment record for this WLAN";case"PROFILE_MAPPING_MISSING":return"Profile to site mapping is broken";case"PROVISIONING_FAILED":return"Provisioning job failed or stalled";case"CACHE_STALE":return"Cached data may be out of sync";case"OBSERVED_ONLY":return"WLAN is broadcasting but not in intended configuration";case"INTENDED_ONLY":return"WLAN is configured but not observed broadcasting";default:return"Unknown mismatch"}}getMismatchBadgeVariant(a){switch(this.getMismatchSeverity(a)){case"error":return"destructive";case"warning":return"default";case"info":return"outline";default:return"secondary"}}needsDeployment(a){return this.getWLANDeploymentStatus(a)==="NOT_DEPLOYED"}getDeploymentSummary(a){const i=this.getWLANDeploymentStatus(a),c=q.getWLANSiteAssignments(a),m=q.getWLANProfileAssignments(a),d=c.length,N=m.filter(s=>s.expectedState==="ASSIGNED").length,v=m.filter(s=>s.mismatch!==null).length,t=i==="NOT_DEPLOYED"||i==="PARTIALLY_DEPLOYED"||v>0;return{status:i,sites:d,profiles:N,mismatches:v,needsAction:t}}}const Xe=new Bs;function Us({open:r,onOpenChange:a,siteId:i,siteName:c}){const[m,d]=w.useState(!1),[N,v]=w.useState(null),[t,s]=w.useState(null),[n,o]=w.useState(null),[u,j]=w.useState(!1),[f,x]=w.useState(null),[h,E]=w.useState(!1),[C,A]=w.useState(null);w.useEffect(()=>{r&&i&&R()},[r,i]);const R=async()=>{d(!0),v(null);try{console.log(`[SiteWLANDialog] Loading WLAN assignment summary for site ${i}`);const S=await ne.getSiteWLANAssignmentSummary(i);s(S),console.log("[SiteWLANDialog] Assignment summary loaded successfully:",S),console.log("[SiteWLANDialog] Summary breakdown:"),console.log(`  - Device Groups: ${S.deviceGroupCount}`),console.log(`  - Profiles: ${S.profileCount}`),console.log(`  - WLANs: ${S.wlanCount}`),console.log("[SiteWLANDialog] Device Groups:",S.deviceGroups),console.log("[SiteWLANDialog] Profiles:",S.profiles),console.log("[SiteWLANDialog] WLANs:",S.wlans);const p=await Xe.createSiteInventory(i,c,S.wlans||[],S.profiles||[],[]);o(p),console.log("[SiteWLANDialog] Site inventory created:",p)}catch(S){const p=S instanceof Error?S.message:"Failed to load WLAN assignments";v(p),console.error("[SiteWLANDialog] Error loading WLAN assignments:",S),T.error("Failed to load WLAN assignments",{description:p})}finally{d(!1)}},M=(S,p)=>{x({id:S,name:p}),j(!0)},G=S=>{A(S),E(!0)},U=()=>{j(!1),R()},F=S=>{const p=S?.toLowerCase()||"unknown";return p.includes("open")?e.jsxs(I,{variant:"outline",className:"gap-1",children:[e.jsx(re,{className:"h-3 w-3"})," Open"]}):p.includes("wpa3")?e.jsxs(I,{variant:"default",className:"gap-1",children:[e.jsx(re,{className:"h-3 w-3"})," WPA3"]}):p.includes("wpa2-enterprise")||p.includes("enterprise")?e.jsxs(I,{variant:"secondary",className:"gap-1",children:[e.jsx(re,{className:"h-3 w-3"})," WPA2-Enterprise"]}):p.includes("wpa2")?e.jsxs(I,{variant:"secondary",className:"gap-1",children:[e.jsx(re,{className:"h-3 w-3"})," WPA2"]}):e.jsx(I,{variant:"outline",children:S||"Unknown"})},Z=S=>S?e.jsxs(I,{variant:"outline",className:"gap-1",children:[e.jsx(jt,{className:"h-3 w-3"}),S]}):null;return e.jsxs(at,{isOpen:r,onClose:()=>a(!1),title:`WLAN Assignments - ${c}`,description:"View WLANs and their profile assignments for this site",width:"xl",children:[m?e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Te,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),e.jsx("div",{className:"space-y-2",children:[1,2,3].map(S=>e.jsx(Se,{className:"h-20 w-full"},S))})]}):N?e.jsxs(Ee,{variant:"destructive",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx(be,{children:N})]}):t?e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs($,{children:[e.jsx(Q,{className:"pb-3",children:e.jsxs(H,{className:"text-sm flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4"}),"Device Groups"]})}),e.jsx(Y,{children:e.jsx("div",{className:"text-2xl font-bold",children:t.deviceGroupCount})})]}),e.jsxs($,{children:[e.jsx(Q,{className:"pb-3",children:e.jsxs(H,{className:"text-sm flex items-center gap-2",children:[e.jsx(_e,{className:"h-4 w-4"}),"Profiles"]})}),e.jsx(Y,{children:e.jsx("div",{className:"text-2xl font-bold",children:t.profileCount})})]}),e.jsxs($,{children:[e.jsx(Q,{className:"pb-3",children:e.jsxs(H,{className:"text-sm flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),"WLANs"]})}),e.jsx(Y,{children:e.jsx("div",{className:"text-2xl font-bold",children:t.wlanCount})})]})]}),e.jsxs($,{children:[e.jsxs(Q,{children:[e.jsxs(H,{className:"text-base flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),"WLANs in this Site"]}),e.jsx(Pe,{children:"Wireless networks and their deployment status"})]}),e.jsxs(Y,{children:[n&&n.mismatches.length>0&&e.jsxs(Ee,{variant:"destructive",className:"mb-4",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsxs(be,{children:[n.mismatches.length," mismatch",n.mismatches.length!==1?"es":""," detected. Review WLANs below for details."]})]}),t.wlans.length===0?e.jsxs("div",{className:"text-center py-6 text-muted-foreground text-sm",children:[e.jsx(Ae,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No WLANs found in this site"]}):e.jsx("div",{className:"space-y-2",children:n?.intendedWLANs.map(S=>{const p=S.wlan,_=S.mismatchReason!==null,J=S.deploymentStatus;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Ce,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[p.ssid||p.name||p.serviceName||p.id,_&&e.jsx(Fe,{className:"h-4 w-4 text-orange-500"}),J==="NOT_DEPLOYED"&&e.jsx(I,{variant:"destructive",className:"text-xs",children:"Not Deployed"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground mt-1",children:[p.vlan&&e.jsxs("span",{children:["VLAN ",p.vlan]}),S.expectedProfiles>0&&e.jsxs(e.Fragment,{children:[p.vlan&&e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsxs("span",{children:["Expected: ",S.expectedProfiles," profile",S.expectedProfiles!==1?"s":""]}),e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsxs("span",{className:_?"text-orange-500 font-medium":"",children:["Actual: ",S.actualProfiles," profile",S.actualProfiles!==1?"s":""]})]}),_&&S.mismatchReason&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsx(I,{variant:Xe.getMismatchBadgeVariant(S.mismatchReason),className:"text-xs",children:Xe.getMismatchDescription(S.mismatchReason)})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[F(p.security),Z(p.band),e.jsxs(O,{variant:"outline",size:"sm",onClick:()=>G(p),className:"gap-1",title:"Download WiFi QR Code",children:[e.jsx(cs,{className:"h-3 w-3"}),"QR Code"]}),S.expectedProfiles>0&&e.jsxs(O,{variant:"outline",size:"sm",onClick:()=>M(p.id,p.ssid||p.name||p.serviceName||p.id),className:"gap-1",children:[e.jsx(Re,{className:"h-3 w-3"}),"Reconcile"]})]})]},p.id)})})]})]}),e.jsxs($,{children:[e.jsxs(Q,{children:[e.jsxs(H,{className:"text-base flex items-center gap-2",children:[e.jsx(_e,{className:"h-4 w-4"}),"Profile WLAN Assignments"]}),e.jsx(Pe,{children:"Which WLANs are assigned to each profile"})]}),e.jsx(Y,{children:t.profiles.length===0?e.jsxs("div",{className:"text-center py-6 text-muted-foreground text-sm",children:[e.jsx(Ae,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No profiles found in this site"]}):e.jsx("div",{className:"space-y-4",children:t.profiles.map(S=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx(_e,{className:"h-4 w-4 text-muted-foreground"}),S.name||S.profileName||S.id]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Device Group: ",S.deviceGroupName]})]}),e.jsxs(I,{variant:"secondary",children:[S.wlans?.length||0," WLAN",S.wlans?.length!==1?"s":""]})]}),S.wlans&&S.wlans.length>0?e.jsx("div",{className:"space-y-2 pl-6",children:S.wlans.map(p=>e.jsxs("div",{className:"flex items-center gap-2 text-sm p-2 bg-secondary/5 rounded border border-secondary/10",children:[e.jsx(Ce,{className:"h-3 w-3 text-secondary"}),e.jsx("span",{className:"flex-1",children:p.ssid||p.name||p.serviceName||p.id}),e.jsxs("div",{className:"flex items-center gap-1",children:[F(p.security),p.band&&e.jsx(I,{variant:"outline",className:"text-xs",children:p.band})]})]},p.id))}):e.jsx("div",{className:"text-xs text-muted-foreground pl-6",children:"No WLANs assigned to this profile"})]},S.id))})})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No data available"}),f&&e.jsx(Is,{open:u,onOpenChange:U,wlanId:f.id,wlanName:f.name}),C&&e.jsx(Gs,{open:h,onOpenChange:E,wlan:C})]})}function $s({tableId:r,columns:a,storageKey:i,enableViews:c=!1,enablePersistence:m=!0,userId:d,scope:N="user",onPreferencesChange:v,onViewLoad:t}){const s=w.useMemo(()=>a.filter(l=>l.defaultVisible!==!1).map(l=>l.key),[a]),n=w.useMemo(()=>a.map(l=>l.key),[a]),o=w.useMemo(()=>a.reduce((l,g)=>(g.defaultWidth&&(l[g.key]=g.defaultWidth),l),{}),[a]),[u,j]=w.useState(s),[f,x]=w.useState(n),[h,E]=w.useState(o),[C,A]=w.useState([]),[R,M]=w.useState([]),[G,U]=w.useState(),[F,Z]=w.useState(!0),[S,p]=w.useState(!1),_=i||`${r}-columns`;w.useEffect(()=>{(async()=>{try{if(Z(!0),m&&d)try{const{tablePreferencesService:y}=await le(async()=>{const{tablePreferencesService:k}=await import("./tablePreferences-D3IEhiLd.js");return{tablePreferencesService:k}},__vite__mapDeps([0,1,2,3,4])),b=await y.fetchPreferences(r,d,N);if(b){j(b.visibleColumns),b.columnOrder&&x(b.columnOrder),b.columnWidths&&E(b.columnWidths),b.pinnedColumns&&A(b.pinnedColumns),b.currentView&&U(b.currentView),Z(!1);return}}catch(y){console.warn("Failed to load from server, falling back to localStorage:",y)}const g=localStorage.getItem(_);if(g)try{const y=JSON.parse(g);j(y.visibleColumns||s),y.columnOrder&&x(y.columnOrder),y.columnWidths&&E(y.columnWidths),y.pinnedColumns&&A(y.pinnedColumns),y.currentView&&U(y.currentView)}catch(y){console.error("Failed to parse saved preferences:",y)}if(c&&d)try{const{tablePreferencesService:y}=await le(async()=>{const{tablePreferencesService:k}=await import("./tablePreferences-D3IEhiLd.js");return{tablePreferencesService:k}},__vite__mapDeps([0,1,2,3,4])),b=await y.fetchViews(r,d);M(b)}catch(y){console.warn("Failed to load saved views:",y)}}catch(g){console.error("Failed to load table preferences:",g)}finally{Z(!1)}})()},[r,d,N,m,c,_,s]),w.useEffect(()=>{if(F)return;(async()=>{const g={tableId:r,userId:d,scope:N,visibleColumns:u,columnOrder:f,columnWidths:h,pinnedColumns:C,currentView:G,lastModified:new Date().toISOString()};try{localStorage.setItem(_,JSON.stringify(g))}catch(y){console.error("Failed to save to localStorage:",y)}if(m&&d)try{const{tablePreferencesService:y}=await le(async()=>{const{tablePreferencesService:b}=await import("./tablePreferences-D3IEhiLd.js");return{tablePreferencesService:b}},__vite__mapDeps([0,1,2,3,4]));await y.savePreferences(g)}catch(y){console.error("Failed to save preferences to server:",y)}v?.(g)})(),p(!1)},[u,f,h,C,G,F,r,d,N,m,_,v]);const J=w.useCallback(l=>{j(g=>{const b=g.includes(l)?g.filter(k=>k!==l):[...g,l];return p(!0),b})},[]),V=w.useCallback(l=>{j(g=>{const y=Array.from(new Set([...g,...l]));return p(!0),y})},[]),P=w.useCallback(l=>{j(g=>{const y=g.filter(b=>!l.includes(b));return p(!0),y})},[]),B=w.useCallback(()=>{j(s),x(n),E(o),A([]),U(void 0),p(!1)},[s,n,o]),X=w.useCallback((l,g)=>{E(y=>{const b={...y,[l]:g};return p(!0),b})},[]),K=w.useCallback(l=>{A(g=>{if(g.includes(l))return g;const y=[...g,l];return p(!0),y})},[]),ce=w.useCallback(l=>{A(g=>{const y=g.filter(b=>b!==l);return p(!0),y})},[]),de=w.useCallback(l=>{x(l),p(!0)},[]),ge=w.useCallback(async l=>{if(!c||!d)throw new Error("Views are not enabled or user ID is missing");try{const{tablePreferencesService:g}=await le(async()=>{const{tablePreferencesService:b}=await import("./tablePreferences-D3IEhiLd.js");return{tablePreferencesService:b}},__vite__mapDeps([0,1,2,3,4])),y=await g.saveView(r,{...l,createdBy:d,columns:u,columnWidths:h,pinnedColumns:C});return M(b=>[...b,y]),p(!1),y}catch(g){throw console.error("Failed to save view:",g),g}},[r,d,c,u,h,C]),Ne=w.useCallback(l=>{const g=R.find(y=>y.id===l);g&&(j(g.columns),g.columnWidths&&E(g.columnWidths),g.pinnedColumns&&A(g.pinnedColumns),U(l),p(!1),t?.(g))},[R,t]),je=w.useCallback(async l=>{if(!c)throw new Error("Views are not enabled");try{const{tablePreferencesService:g}=await le(async()=>{const{tablePreferencesService:y}=await import("./tablePreferences-D3IEhiLd.js");return{tablePreferencesService:y}},__vite__mapDeps([0,1,2,3,4]));await g.deleteView(l),M(y=>y.filter(b=>b.id!==l)),G===l&&U(void 0)}catch(g){throw console.error("Failed to delete view:",g),g}},[G,c]),ve=w.useCallback(async(l,g)=>{if(!c)throw new Error("Views are not enabled");try{const{tablePreferencesService:y}=await le(async()=>{const{tablePreferencesService:b}=await import("./tablePreferences-D3IEhiLd.js");return{tablePreferencesService:b}},__vite__mapDeps([0,1,2,3,4]));await y.shareView(l,g),M(b=>b.map(k=>k.id===l?{...k,isShared:!0,sharedWith:g}:k))}catch(y){throw console.error("Failed to share view:",y),y}},[c]),Ue=w.useCallback(async l=>{if(!c||!d)throw new Error("Views are not enabled or user ID is missing");try{const{tablePreferencesService:g}=await le(async()=>{const{tablePreferencesService:y}=await import("./tablePreferences-D3IEhiLd.js");return{tablePreferencesService:y}},__vite__mapDeps([0,1,2,3,4]));await g.setDefaultView(r,l,d),M(y=>y.map(b=>({...b,isDefault:b.id===l})))}catch(g){throw console.error("Failed to set default view:",g),g}},[r,d,c]),we=w.useMemo(()=>f.filter(l=>u.includes(l)).map(l=>a.find(g=>g.key===l)).filter(l=>l!==void 0),[f,u,a]),ue=w.useMemo(()=>we.map(l=>l.fieldPath||l.key).filter(Boolean),[we]);return{...{tableId:r,columns:a,visibleColumns:u,columnOrder:f,columnWidths:h,pinnedColumns:C,savedViews:R,currentView:G,enableViews:c,enablePersistence:m,isLoading:F},visibleColumnConfigs:we,projectionFields:ue,hasUnsavedChanges:S,...{toggleColumn:J,showColumns:V,hideColumns:P,resetColumns:B,setColumnWidth:X,pinColumn:K,unpinColumn:ce,reorderColumns:de,saveView:ge,loadView:Ne,deleteView:je,shareView:ve,setDefaultView:Ue}}}var te="Accordion",Qs=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[rt,Ys,Hs]=Kt(te),[Ge]=qt(te,[Hs,yt]),lt=yt(),Ot=D.forwardRef((r,a)=>{const{type:i,...c}=r,m=c,d=c;return e.jsx(rt.Provider,{scope:r.__scopeAccordion,children:i==="multiple"?e.jsx(Zs,{...d,ref:a}):e.jsx(qs,{...m,ref:a})})});Ot.displayName=te;var[Tt,Xs]=Ge(te),[_t,Ks]=Ge(te,{collapsible:!1}),qs=D.forwardRef((r,a)=>{const{value:i,defaultValue:c,onValueChange:m=()=>{},collapsible:d=!1,...N}=r,[v,t]=ft({prop:i,defaultProp:c??"",onChange:m,caller:te});return e.jsx(Tt,{scope:r.__scopeAccordion,value:D.useMemo(()=>v?[v]:[],[v]),onItemOpen:t,onItemClose:D.useCallback(()=>d&&t(""),[d,t]),children:e.jsx(_t,{scope:r.__scopeAccordion,collapsible:d,children:e.jsx(Wt,{...N,ref:a})})})}),Zs=D.forwardRef((r,a)=>{const{value:i,defaultValue:c,onValueChange:m=()=>{},...d}=r,[N,v]=ft({prop:i,defaultProp:c??[],onChange:m,caller:te}),t=D.useCallback(n=>v((o=[])=>[...o,n]),[v]),s=D.useCallback(n=>v((o=[])=>o.filter(u=>u!==n)),[v]);return e.jsx(Tt,{scope:r.__scopeAccordion,value:N,onItemOpen:t,onItemClose:s,children:e.jsx(_t,{scope:r.__scopeAccordion,collapsible:!0,children:e.jsx(Wt,{...d,ref:a})})})}),[Js,Be]=Ge(te),Wt=D.forwardRef((r,a)=>{const{__scopeAccordion:i,disabled:c,dir:m,orientation:d="vertical",...N}=r,v=D.useRef(null),t=Jt(v,a),s=Ys(i),o=es(m)==="ltr",u=ts(r.onKeyDown,j=>{if(!Qs.includes(j.key))return;const f=j.target,x=s().filter(F=>!F.ref.current?.disabled),h=x.findIndex(F=>F.ref.current===f),E=x.length;if(h===-1)return;j.preventDefault();let C=h;const A=0,R=E-1,M=()=>{C=h+1,C>R&&(C=A)},G=()=>{C=h-1,C<A&&(C=R)};switch(j.key){case"Home":C=A;break;case"End":C=R;break;case"ArrowRight":d==="horizontal"&&(o?M():G());break;case"ArrowDown":d==="vertical"&&M();break;case"ArrowLeft":d==="horizontal"&&(o?G():M());break;case"ArrowUp":d==="vertical"&&G();break}const U=C%E;x[U].ref.current?.focus()});return e.jsx(Js,{scope:i,disabled:c,direction:m,orientation:d,children:e.jsx(rt.Slot,{scope:i,children:e.jsx(ht.div,{...N,"data-orientation":d,ref:t,onKeyDown:c?void 0:u})})})}),ze="AccordionItem",[en,ot]=Ge(ze),Ft=D.forwardRef((r,a)=>{const{__scopeAccordion:i,value:c,...m}=r,d=Be(ze,i),N=Xs(ze,i),v=lt(i),t=Zt(),s=c&&N.value.includes(c)||!1,n=d.disabled||r.disabled;return e.jsx(en,{scope:i,open:s,disabled:n,triggerId:t,children:e.jsx(bs,{"data-orientation":d.orientation,"data-state":$t(s),...v,...m,ref:a,disabled:n,open:s,onOpenChange:o=>{o?N.onItemOpen(c):N.onItemClose(c)}})})});Ft.displayName=ze;var Vt="AccordionHeader",zt=D.forwardRef((r,a)=>{const{__scopeAccordion:i,...c}=r,m=Be(te,i),d=ot(Vt,i);return e.jsx(ht.h3,{"data-orientation":m.orientation,"data-state":$t(d.open),"data-disabled":d.disabled?"":void 0,...c,ref:a})});zt.displayName=Vt;var nt="AccordionTrigger",Gt=D.forwardRef((r,a)=>{const{__scopeAccordion:i,...c}=r,m=Be(te,i),d=ot(nt,i),N=Ks(nt,i),v=lt(i);return e.jsx(rt.ItemSlot,{scope:i,children:e.jsx(Ps,{"aria-disabled":d.open&&!N.collapsible||void 0,"data-orientation":m.orientation,id:d.triggerId,...v,...c,ref:a})})});Gt.displayName=nt;var Bt="AccordionContent",Ut=D.forwardRef((r,a)=>{const{__scopeAccordion:i,...c}=r,m=Be(te,i),d=ot(Bt,i),N=lt(i);return e.jsx(Rs,{role:"region","aria-labelledby":d.triggerId,"data-orientation":m.orientation,...N,...c,ref:a,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...r.style}})});Ut.displayName=Bt;function $t(r){return r?"open":"closed"}var tn=Ot,sn=Ft,nn=zt,an=Gt,rn=Ut;function ln({...r}){return e.jsx(tn,{"data-slot":"accordion",...r})}function on({className:r,...a}){return e.jsx(sn,{"data-slot":"accordion-item",className:it("border-b last:border-b-0",r),...a})}function cn({className:r,children:a,...i}){return e.jsx(nn,{className:"flex",children:e.jsxs(an,{"data-slot":"accordion-trigger",className:it("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",r),...i,children:[a,e.jsx(ds,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function dn({className:r,children:a,...i}){return e.jsx(rn,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...i,children:e.jsx("div",{className:it("pt-0 pb-4",r),children:a})})}function un({columns:r,visibleColumns:a,onChange:i,groupByCategory:c=!0,showSearch:m=!0,showQuickActions:d=!0}){const[N,v]=w.useState(""),t=w.useMemo(()=>{const h=r.filter(C=>C.label.toLowerCase().includes(N.toLowerCase()));return c?h.reduce((C,A)=>{const R=A.category||"other";return C[R]||(C[R]=[]),C[R].push(A),C},{}):{all:h}},[r,N,c]),s=h=>({basic:"Basic Information",devices:"Devices",metrics:"Metrics & Performance",status:"Status",network:"Network",advanced:"Advanced",security:"Security",performance:"Performance",other:"Other"})[h]||h,n=h=>{if(o(h))return;const E=a.includes(h)?a.filter(C=>C!==h):[...a,h];i(E)},o=h=>r.find(C=>C.key===h)?.lockVisible===!0,u=()=>{const h=r.map(E=>E.key);i(h)},j=()=>{const h=r.filter(E=>E.lockVisible===!0).map(E=>E.key);i(h)},f=()=>{const h=r.filter(E=>E.defaultVisible!==!1).map(E=>E.key);i(h)},x=h=>h.filter(E=>a.includes(E.key)).length;return e.jsxs("div",{className:"space-y-4",children:[(m||d)&&e.jsxs("div",{className:"space-y-3",children:[m&&e.jsxs("div",{className:"relative",children:[e.jsx(wt,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(se,{placeholder:"Search columns...",value:N,onChange:h=>v(h.target.value),className:"pl-9"})]}),d&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(O,{variant:"outline",size:"sm",onClick:u,className:"flex-1",children:[e.jsx(us,{className:"mr-2 h-4 w-4"}),"Show All"]}),e.jsxs(O,{variant:"outline",size:"sm",onClick:j,className:"flex-1",children:[e.jsx(ms,{className:"mr-2 h-4 w-4"}),"Hide All"]}),e.jsx(O,{variant:"outline",size:"sm",onClick:f,children:"Reset"})]})]}),c?e.jsx(ln,{type:"multiple",defaultValue:Object.keys(t),className:"w-full",children:Object.entries(t).map(([h,E])=>e.jsxs(on,{value:h,children:[e.jsx(cn,{className:"hover:no-underline",children:e.jsxs("div",{className:"flex items-center justify-between flex-1 pr-4",children:[e.jsx("span",{className:"font-medium",children:s(h)}),e.jsxs(I,{variant:"secondary",className:"ml-2",children:[x(E)," / ",E.length]})]})}),e.jsx(dn,{children:e.jsx("div",{className:"space-y-2 pt-2",children:E.map(C=>e.jsx(mt,{column:C,isVisible:a.includes(C.key),isLocked:o(C.key),onToggle:()=>n(C.key)},C.key))})})]},h))}):e.jsx("div",{className:"space-y-2",children:r.map(h=>e.jsx(mt,{column:h,isVisible:a.includes(h.key),isLocked:o(h.key),onToggle:()=>n(h.key)},h.key))}),e.jsxs("div",{className:"pt-2 border-t text-sm text-muted-foreground",children:[a.length," of ",r.length," columns visible"]})]})}function mt({column:r,isVisible:a,isLocked:i,onToggle:c}){return e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded-md hover:bg-muted/50 transition-colors",children:[e.jsx(Es,{id:r.key,checked:a,onCheckedChange:c,disabled:i}),e.jsxs(ee,{htmlFor:r.key,className:"flex-1 cursor-pointer select-none flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:r.label}),r.tooltip&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",r.tooltip,")"]})]}),i&&e.jsx(hs,{className:"h-3 w-3 text-muted-foreground"})]})]})}function mn({customization:r,triggerLabel:a="Customize Columns",showTriggerIcon:i=!0,trigger:c}){const[m,d]=w.useState(!1),[N,v]=w.useState("columns"),[t,s]=w.useState(""),[n,o]=w.useState(""),{columns:u,visibleColumns:j,savedViews:f,currentView:x,enableViews:h,hasUnsavedChanges:E,toggleColumn:C,showColumns:A,hideColumns:R,resetColumns:M,saveView:G,loadView:U,deleteView:F}=r,Z=async()=>{if(!t.trim()){T.error("View name required",{description:"Please enter a name for the view"});return}try{await G({name:t.trim(),description:n.trim()||void 0,tableId:r.tableId,columns:j,createdBy:""}),T.success("View saved",{description:`"${t}" has been saved successfully`}),s(""),o(""),v("views")}catch(P){T.error("Failed to save view",{description:P instanceof Error?P.message:"Unknown error"})}},S=P=>{U(P),T.success("View loaded",{description:"Column configuration has been updated"})},p=async P=>{try{await F(P),T.success("View deleted",{description:"The view has been removed"})}catch(B){T.error("Failed to delete view",{description:B instanceof Error?B.message:"Unknown error"})}},_=()=>{M(),T.success("Reset to defaults",{description:"Column configuration has been reset"})},J=()=>{const P={tableId:r.tableId,visibleColumns:j,columnOrder:r.columnOrder,columnWidths:r.columnWidths,pinnedColumns:r.pinnedColumns},B=new Blob([JSON.stringify(P,null,2)],{type:"application/json"}),X=URL.createObjectURL(B),K=document.createElement("a");K.href=X,K.download=`${r.tableId}-columns.json`,K.click(),URL.revokeObjectURL(X),T.success("Configuration exported",{description:"Column configuration has been downloaded"})},V=e.jsxs(O,{variant:"outline",size:"sm",children:[i&&e.jsx(Ns,{className:"mr-2 h-4 w-4"}),a,E&&e.jsx(I,{variant:"destructive",className:"ml-2 h-5 px-1",children:"*"})]});return e.jsxs(Ke,{open:m,onOpenChange:d,children:[e.jsx(is,{asChild:!0,children:c||V}),e.jsxs(qe,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs(Ze,{children:[e.jsxs(Je,{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-5 w-5"}),"Customize Columns"]}),e.jsx(et,{children:"Choose which columns to display and save your preferences."})]}),e.jsxs(ns,{value:N,onValueChange:v,className:"flex-1 overflow-hidden flex flex-col",children:[e.jsxs(as,{className:"grid w-full grid-cols-3",children:[e.jsxs($e,{value:"columns",children:["Columns",E&&e.jsx("span",{className:"ml-2 h-2 w-2 rounded-full bg-orange-500"})]}),e.jsx($e,{value:"save",disabled:!h,children:"Save View"}),e.jsxs($e,{value:"views",disabled:!h||f.length===0,children:["Saved Views",f.length>0&&e.jsx(I,{variant:"secondary",className:"ml-2",children:f.length})]})]}),e.jsx(Qe,{value:"columns",className:"flex-1 overflow-auto mt-4",children:e.jsx(un,{columns:u,visibleColumns:j,onChange:A,groupByCategory:!0,showSearch:!0,showQuickActions:!0})}),e.jsxs(Qe,{value:"save",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{htmlFor:"view-name",children:"View Name *"}),e.jsx(se,{id:"view-name",placeholder:"e.g., My Custom View",value:t,onChange:P=>s(P.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{htmlFor:"view-description",children:"Description"}),e.jsx(Ls,{id:"view-description",placeholder:"Optional description for this view",value:n,onChange:P=>o(P.target.value),rows:3})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-md space-y-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Current Configuration"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[j.length," columns selected"]}),r.pinnedColumns.length>0&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[r.pinnedColumns.length," columns pinned"]})]}),e.jsxs(O,{onClick:Z,className:"w-full",children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"Save View"]})]}),e.jsx(Qe,{value:"views",className:"space-y-2 mt-4 overflow-auto",children:f.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"No saved views yet"}),e.jsx("p",{className:"text-sm mt-2",children:"Customize your columns and save them as a view"})]}):f.map(P=>e.jsx("div",{className:`p-4 border rounded-lg space-y-2 ${x===P.id?"border-primary bg-primary/5":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"font-medium",children:P.name}),P.isDefault&&e.jsx(I,{variant:"secondary",className:"text-xs",children:"Default"}),x===P.id&&e.jsx(I,{variant:"default",className:"text-xs",children:"Active"}),P.isShared&&e.jsx(I,{variant:"outline",className:"text-xs",children:"Shared"})]}),P.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:P.description}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:[P.columns.length," columns"]})]}),e.jsxs("div",{className:"flex gap-2",children:[x!==P.id&&e.jsx(O,{size:"sm",variant:"outline",onClick:()=>S(P.id),children:"Load"}),e.jsx(O,{size:"sm",variant:"ghost",onClick:()=>p(P.id),children:"Delete"})]})]})},P.id))})]}),e.jsxs(rs,{className:"flex items-center justify-between sm:justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(O,{variant:"outline",size:"sm",onClick:_,children:[e.jsx(ps,{className:"mr-2 h-4 w-4"}),"Reset"]}),e.jsxs(O,{variant:"outline",size:"sm",onClick:J,children:[e.jsx(gs,{className:"mr-2 h-4 w-4"}),"Export"]})]}),e.jsx(O,{onClick:()=>d(!1),children:"Done"})]})]})]})}function hn(r){switch(r?.toLowerCase()){case"online":case"up":case"active":return"default";case"partial":case"degraded":return"secondary";case"offline":case"down":case"inactive":return"destructive";default:return"outline"}}function fn(r){switch(r?.toLowerCase()){case"online":case"up":case"active":return e.jsx(Nt,{className:"h-4 w-4 text-green-500"});case"partial":case"degraded":return e.jsx(vs,{className:"h-4 w-4 text-yellow-500"});case"offline":case"down":case"inactive":return e.jsx(Fe,{className:"h-4 w-4 text-red-500"});default:return e.jsx(js,{className:"h-4 w-4 text-gray-500"})}}const xn=[{key:"status",label:"Status",category:"status",dataType:"string",fieldPath:"status",defaultVisible:!0,lockVisible:!1,sortable:!0,defaultWidth:100,renderCell:r=>e.jsxs("div",{className:"flex items-center gap-2",children:[fn(r.status),e.jsx(I,{variant:hn(r.status),children:r.status||"Unknown"})]}),tooltip:"Current operational status"},{key:"siteName",label:"Name",category:"basic",dataType:"string",fieldPath:"siteName",defaultVisible:!0,lockVisible:!0,sortable:!0,defaultWidth:200,renderCell:r=>e.jsx("div",{className:"font-medium",children:r.siteName||r.name||"Unnamed Site"}),tooltip:"Site name"},{key:"country",label:"Country",category:"basic",dataType:"string",fieldPath:"country",defaultVisible:!0,sortable:!0,defaultWidth:120,renderCell:r=>r.country||"—",tooltip:"Country location"},{key:"timezone",label:"Timezone",category:"basic",dataType:"string",fieldPath:"timezone",defaultVisible:!1,sortable:!0,defaultWidth:150,renderCell:r=>r.timezone||"—",tooltip:"Site timezone"},{key:"campus",label:"Campus",category:"basic",dataType:"string",fieldPath:"campus",defaultVisible:!1,sortable:!0,defaultWidth:150,renderCell:r=>r.campus||"—",tooltip:"Campus or building"},{key:"roles",label:"Roles",category:"network",dataType:"number",fieldPath:"roles",defaultVisible:!0,sortable:!0,defaultWidth:100,renderCell:r=>e.jsx("div",{className:"text-center",children:r.roles??0}),tooltip:"Number of network roles"},{key:"networks",label:"Networks",category:"network",dataType:"number",fieldPath:"networks",defaultVisible:!0,sortable:!0,defaultWidth:100,renderCell:r=>e.jsx("div",{className:"text-center",children:r.networks??0}),tooltip:"Number of networks/WLANs"},{key:"switches",label:"Switches",category:"devices",dataType:"number",fieldPath:"switches",defaultVisible:!0,sortable:!0,defaultWidth:100,renderCell:r=>e.jsx("div",{className:"text-center",children:r.switches??0}),tooltip:"Number of switches"},{key:"aps",label:"APs",category:"devices",dataType:"number",fieldPath:"aps",defaultVisible:!0,sortable:!0,defaultWidth:100,renderCell:r=>e.jsx("div",{className:"text-center",children:r.aps??0}),tooltip:"Total access points"},{key:"activeAPs",label:"Active APs",category:"devices",dataType:"number",fieldPath:"activeAPs",defaultVisible:!0,sortable:!0,defaultWidth:120,renderCell:r=>e.jsx("div",{className:"text-center text-green-600",children:r.activeAPs??0}),tooltip:"Currently active access points"},{key:"nonActiveAPs",label:"Non Active APs",category:"devices",dataType:"number",fieldPath:"nonActiveAPs",defaultVisible:!0,sortable:!0,defaultWidth:130,renderCell:r=>e.jsx("div",{className:"text-center text-red-600",children:r.nonActiveAPs??0}),tooltip:"Inactive access points"},{key:"allClients",label:"All Clients",category:"metrics",dataType:"number",fieldPath:"allClients",defaultVisible:!0,sortable:!0,defaultWidth:120,renderCell:r=>e.jsx("div",{className:"text-center",children:r.allClients??0}),tooltip:"Total connected clients"},{key:"adoptionPrimary",label:"Primary Platform",category:"advanced",dataType:"string",fieldPath:"adoptionPrimary",defaultVisible:!1,sortable:!0,defaultWidth:180,renderCell:r=>r.adoptionPrimary||"—",tooltip:"Primary Extreme Platform ONE address"},{key:"adoptionBackup",label:"Backup Platform",category:"advanced",dataType:"string",fieldPath:"adoptionBackup",defaultVisible:!1,sortable:!0,defaultWidth:180,renderCell:r=>r.adoptionBackup||"—",tooltip:"Backup Extreme Platform ONE address"}];function Rn({onShowDetail:r}){const[a,i]=w.useState([]),[c,m]=w.useState([]),[d,N]=w.useState(!0),[v,t]=w.useState(null),[s,n]=w.useState(""),[o,u]=w.useState([]),[j,f]=w.useState(!1),[x,h]=w.useState(!1),[E,C]=w.useState(!1),[A,R]=w.useState(null),[M,G]=w.useState(null),[U,F]=w.useState(""),[Z,S]=w.useState(!1),[p,_]=w.useState({name:"",country:"",timezone:"",description:""}),[J,V]=w.useState(0),[P,B]=w.useState(""),X=$s({tableId:"sites",columns:xn,enableViews:!0,enablePersistence:!0,userId:localStorage.getItem("user_email")||"default-user"});w.useEffect(()=>{let l=!0,g={current:null};return(async()=>{try{ce(),g.current=setTimeout(()=>{l&&(console.warn("Sites loading took too long, forcing stop"),N(!1),V(0),B(""),t("Loading sites timed out. Please try refreshing the page."))},1e4),await K(),g.current&&(clearTimeout(g.current),g.current=null)}catch(b){l&&(console.error("Failed to initialize sites component:",b),N(!1),V(0),B(""),t("Failed to initialize sites. Please try refreshing the page.")),g.current&&(clearTimeout(g.current),g.current=null)}})(),()=>{l=!1,g.current&&clearTimeout(g.current),ne.cancelAllRequests()}},[]),w.useEffect(()=>{if(!Array.isArray(a)){u([]);return}const l=a.filter(g=>{if(!g||typeof g!="object")return!1;const y=s.toLowerCase();return g.siteName&&g.siteName.toLowerCase().includes(y)||g.name&&g.name.toLowerCase().includes(y)||g.country&&g.country.toLowerCase().includes(y)||g.campus&&g.campus.toLowerCase().includes(y)});u(l)},[a,s]);const K=async(l=0)=>{try{l===0&&(N(!0),t(null)),B(`Loading sites${l>0?` (retry ${l})`:""}...`),V(30),console.log(`Loading sites from API (attempt ${l+1}/2)...`),V(50),B("Fetching sites data...");const b=await ne.makeAuthenticatedRequest("/v3/sites",{method:"GET"},6e3);if(!b.ok)throw new Error(`Failed to fetch sites: ${b.status} ${b.statusText}`);const k=await b.json();console.log("Raw sites data from API:",k);let me=[];Array.isArray(k)?me=k:k&&Array.isArray(k.sites)?me=k.sites:k&&Array.isArray(k.data)?me=k.data:(console.warn("Unexpected sites data format:",k),me=[]),V(70),B("Fetching client data...");let Le=new Map;try{console.log("Fetching stations for client counts..."),(await ne.getStationsWithSiteCorrelation()).forEach(ae=>{const ie=ae.siteId||ae.site_id;ie&&Le.set(ie,(Le.get(ie)||0)+1)}),console.log("Client counts by site:",Object.fromEntries(Le))}catch(z){console.warn("Failed to fetch client data, client counts will be 0:",z)}V(90),B("Processing site data...");const he=me.map(z=>{const ae=z.deviceGroups?.reduce((Ht,Xt)=>Ht+(Xt.apSerialNumbers?.length||0),0)||0,ie=z.switchSerialNumbers?.length||0,Yt=z.deviceGroups?.length||0;return{...z,name:z.siteName,siteName:z.siteName,aps:ae,switches:ie,networks:Yt,roles:0,adoptionPrimary:z.adoptionPrimary||"",adoptionBackup:z.adoptionBackup||"",activeAPs:z.activeAPs||ae,nonActiveAPs:z.nonActiveAPs||0,allClients:Le.get(z.id)||0,campus:z.treeNode?.campus||z.campus||"",status:z.status||(ae+ie>0?"active":"inactive")}});if(console.log("Processed sites:",he),i(he),V(100),B("Complete!"),t(null),setTimeout(()=>{N(!1),V(0),B("")},500),he.length===0)console.warn("No sites returned from API"),T.info("No sites found",{description:"No sites are currently configured in the system."});else{const z=he.reduce((ae,ie)=>ae+(ie.allClients||0),0);console.log(`Loaded ${he.length} sites with ${z} total clients successfully`),T.success(`Loaded ${he.length} sites successfully`,{description:z>0?`${z} connected clients`:void 0})}}catch(b){const k=b instanceof Error?b.message:"Failed to load sites";if(console.error(`Error loading sites (attempt ${l+1}):`,b),l<1&&!k.includes("Session expired")&&!k.includes("Authentication required")&&!k.includes("403")&&!k.includes("404")&&!k.includes("422")){console.log("Retrying in 2000ms..."),T.warning("Loading sites failed, retrying...",{description:k,duration:3e3}),setTimeout(()=>{K(l+1)},2e3);return}t(k),N(!1),V(0),B(""),T.error("Failed to load sites",{description:`${k}${l>0?` (after ${l+1} attempts)`:""}`,duration:8e3})}},ce=async()=>{m([])},de=async()=>{if(!p.name.trim()){T.error("Site name is required");return}try{console.log("Creating site with data:",p);const l={siteName:p.name.trim(),...p.country&&{country:p.country},...p.timezone&&{timezone:p.timezone},...p.description&&{description:p.description.trim()}};console.log("Site creation payload:",l);const g=await ne.createSite(l);console.log("Site created successfully:",g),f(!1),_({name:"",country:"",timezone:"",description:""}),T.success("Site created successfully",{description:`Site "${p.name}" has been created.`}),K()}catch(l){const g=l instanceof Error?l.message:"Failed to create site";console.error("Site creation error:",l),T.error("Failed to create site",{description:g,duration:8e3})}},ge=async()=>{T.info("Site editing not yet implemented",{description:"Please use the Extreme Platform ONE web interface to edit sites."})},Ne=async l=>{T.info("Site deletion not yet implemented",{description:"Please use the Extreme Platform ONE web interface to delete sites."})},je=async l=>{T.info("Site cloning not yet implemented",{description:"Please use the Extreme Platform ONE web interface to clone sites."})},ve=l=>{R(l),_({name:l.name||"",country:l.country||"",timezone:l.timezone||"",description:l.description||""}),h(!0)},Ue=()=>{_({name:"",country:"",timezone:"",description:""}),f(!0)},we=l=>{G({id:l.id,name:l.siteName||l.name}),C(!0)},ue=Array.isArray(c)?c.filter(l=>!l||typeof l!="object"||!l.name?!1:l.name.toLowerCase().includes(U.toLowerCase())):[],ye=(Array.isArray(c)?c.find(l=>l&&l.name===p.country):null)?.timezones||[];return d?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(l=>e.jsxs($,{className:"surface-1dp",children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"h-4 w-20"}),e.jsx(Se,{className:"h-4 w-4"})]}),e.jsxs(Y,{children:[e.jsx(Se,{className:"h-8 w-16 mb-2"}),e.jsx(Se,{className:"h-3 w-24"})]})]},l))}),e.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:e.jsxs($,{className:"w-full max-w-md",children:[e.jsxs(Q,{className:"text-center",children:[e.jsxs(H,{className:"flex items-center justify-center space-x-2",children:[e.jsx(Ye,{className:"h-5 w-5 animate-pulse"}),e.jsx("span",{children:"Loading Sites"})]}),e.jsx(Pe,{children:"Fetching site data from Extreme Platform ONE..."})]}),e.jsxs(Y,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:P}),e.jsxs("span",{children:[J,"%"]})]}),e.jsx("div",{className:"w-full bg-secondary/20 rounded-full h-2",children:e.jsx("div",{className:"bg-secondary h-2 rounded-full transition-all duration-300",style:{width:`${J}%`}})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(O,{variant:"outline",size:"sm",onClick:()=>{ne.cancelAllRequests(),N(!1),t("Load operation cancelled by user")},children:"Cancel"})})]})]})})]}):v?e.jsxs(Ee,{children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsxs(be,{children:[v,e.jsxs(O,{variant:"outline",size:"sm",onClick:()=>{t(null),K()},className:"ml-4",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Retry"]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs($,{className:"surface-1dp",children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(H,{className:"text-sm font-medium",children:"Total Sites"}),e.jsx(ws,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Network locations"})]})]}),e.jsxs($,{className:"surface-1dp",children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(H,{className:"text-sm font-medium",children:"Active Sites"}),e.jsx(Ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.filter(l=>l.status?.toLowerCase()==="active").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sites with devices"})]})]}),e.jsxs($,{className:"surface-1dp",children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(H,{className:"text-sm font-medium",children:"Total Devices"}),e.jsx(vt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.reduce((l,g)=>l+(g.aps||0)+(g.switches||0),0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"APs and switches"})]})]}),e.jsxs($,{className:"surface-1dp",children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(H,{className:"text-sm font-medium",children:"Total Clients"}),e.jsx(_e,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.reduce((l,g)=>l+(g.allClients||0),0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Connected users"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(wt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(se,{placeholder:"Search sites...",value:s,onChange:l=>n(l.target.value),className:"pl-10 w-64"})]}),e.jsxs(O,{variant:"outline",onClick:()=>{t(null),K()},disabled:d,children:[e.jsx(Re,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(mn,{customization:X,triggerLabel:"Customize Columns",showTriggerIcon:!0}),e.jsxs(O,{onClick:Ue,children:[e.jsx(ys,{className:"h-4 w-4 mr-2"}),"Add Site"]})]})]}),e.jsxs($,{className:"surface-2dp",children:[e.jsxs(Q,{children:[e.jsxs(H,{className:"flex items-center space-x-2 text-headline-6 text-high-emphasis",children:[e.jsx(Ye,{className:"h-5 w-5"}),e.jsxs("span",{children:["Sites (",o.length,")"]})]}),e.jsx(Pe,{children:"Manage and configure network sites"})]}),e.jsx(Y,{children:e.jsxs("div",{className:"border rounded-lg",children:[e.jsxs(xt,{children:[e.jsx(pt,{children:e.jsxs(We,{children:[X.visibleColumnConfigs.map(l=>e.jsx(fe,{style:{width:X.columnWidths[l.key]},children:l.label},l.key)),e.jsx(fe,{children:"Actions"})]})}),e.jsx(gt,{children:o.map(l=>e.jsxs(We,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>r?.(l.id,l.siteName||l.name),children:[X.visibleColumnConfigs.map(g=>e.jsx(xe,{children:g.renderCell?g.renderCell(l):l[g.key]},g.key)),e.jsx(xe,{children:e.jsxs("div",{className:"flex items-center space-x-1",onClick:g=>g.stopPropagation(),children:[e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>we(l),title:"View WLAN Assignments",children:e.jsx(Ce,{className:"h-4 w-4"})}),e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>ve(l),children:e.jsx(Ss,{className:"h-4 w-4"})}),e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>je(),children:e.jsx(Cs,{className:"h-4 w-4"})}),e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>Ne(),children:e.jsx(As,{className:"h-4 w-4"})})]})})]},l.id))})]}),o.length===0&&!d&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s?"No sites match your search criteria.":'No sites found. Use the "Add Site" button to create your first site.'})]})})]}),e.jsx(Ke,{open:j,onOpenChange:f,children:e.jsxs(qe,{className:"sm:max-w-[500px]",children:[e.jsxs(Ze,{children:[e.jsx(Je,{children:"Create New Site"}),e.jsx(et,{children:"Add a new site to your network infrastructure"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"siteName",children:"Site Name"}),e.jsx(se,{id:"siteName",placeholder:"Site1",value:p.name,onChange:l=>_({...p,name:l.target.value})})]}),e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"country",children:"Country"}),e.jsxs(De,{value:p.country,onValueChange:l=>{_({...p,country:l,timezone:""})},children:[e.jsx(Ie,{children:e.jsx(Me,{placeholder:"Search countries"})}),e.jsxs(ke,{children:[e.jsx("div",{className:"p-2",children:e.jsx(se,{placeholder:"Search countries...",value:U,onChange:l=>F(l.target.value),className:"mb-2"})}),ue.length>0?ue.map(l=>e.jsx(Oe,{value:l.name,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ct,{className:"h-4 w-4"}),e.jsx("span",{children:l.name})]})},l.code||l.name)):e.jsx("div",{className:"p-2 text-sm text-muted-foreground",children:"No countries available"})]})]})]}),p.country&&ye.length>0&&e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"timezone",children:"Timezone"}),e.jsxs(De,{value:p.timezone,onValueChange:l=>_({...p,timezone:l}),children:[e.jsx(Ie,{children:e.jsx(Me,{placeholder:"Select timezone"})}),e.jsx(ke,{children:ye.map(l=>e.jsx(Oe,{value:l,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(dt,{className:"h-4 w-4"}),e.jsx("span",{children:l})]})},l))})]})]}),e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"description",children:"Description (Optional)"}),e.jsx(se,{id:"description",placeholder:"Site description...",value:p.description,onChange:l=>_({...p,description:l.target.value})})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(O,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(O,{onClick:de,children:"Create Site"})]})]})]})}),e.jsx(Ke,{open:x,onOpenChange:h,children:e.jsxs(qe,{className:"sm:max-w-[500px]",children:[e.jsxs(Ze,{children:[e.jsx(Je,{children:"Edit Site"}),e.jsx(et,{children:"Update site configuration"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"editSiteName",children:"Site Name"}),e.jsx(se,{id:"editSiteName",placeholder:"Site1",value:p.name,onChange:l=>_({...p,name:l.target.value})})]}),e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"editCountry",children:"Country"}),e.jsxs(De,{value:p.country,onValueChange:l=>{_({...p,country:l,timezone:""})},children:[e.jsx(Ie,{children:e.jsx(Me,{placeholder:"Search countries"})}),e.jsxs(ke,{children:[e.jsx("div",{className:"p-2",children:e.jsx(se,{placeholder:"Search countries...",value:U,onChange:l=>F(l.target.value),className:"mb-2"})}),ue.length>0?ue.map(l=>e.jsx(Oe,{value:l.name,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ct,{className:"h-4 w-4"}),e.jsx("span",{children:l.name})]})},l.code||l.name)):e.jsx("div",{className:"p-2 text-sm text-muted-foreground",children:"No countries available"})]})]})]}),p.country&&ye.length>0&&e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"editTimezone",children:"Timezone"}),e.jsxs(De,{value:p.timezone,onValueChange:l=>_({...p,timezone:l}),children:[e.jsx(Ie,{children:e.jsx(Me,{placeholder:"Select timezone"})}),e.jsx(ke,{children:ye.map(l=>e.jsx(Oe,{value:l,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(dt,{className:"h-4 w-4"}),e.jsx("span",{children:l})]})},l))})]})]}),e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"editDescription",children:"Description (Optional)"}),e.jsx(se,{id:"editDescription",placeholder:"Site description...",value:p.description,onChange:l=>_({...p,description:l.target.value})})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(O,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(O,{onClick:ge,children:"Update Site"})]})]})]})}),M&&e.jsx(Us,{open:E,onOpenChange:C,siteId:M.id,siteName:M.name})]})}export{Rn as ConfigureSites};
