import{j as e}from"./vendor-ui-CO0mBmim.js";import{a as m}from"./vendor-react-BQC692LR.js";import{C as p,b,d as f,B as Z,I as ee,m as T,n as q,o as F,p as P,q as D,e as L,c as W,h as te,w as B,a as h}from"./index-CrdvL8SR.js";import{f as se}from"./units-YHb9M7pt.js";import{R as ae,P as re,_ as ne,A as ie,f as ce,W as oe,v as le,aj as de,S as ue,x as he,C as me}from"./vendor-icons-DmoIqCnf.js";import"./vendor-charts-CCS-1Xlq.js";function je(){const[g,U]=m.useState([]),[C,S]=m.useState(!0),[k,R]=m.useState(!1),[j,G]=m.useState(""),[w,M]=m.useState("all"),[N,z]=m.useState("all"),I=[{id:"network-utilization",title:"Network Utilization",description:"Current network bandwidth usage across all sites",unit:"%",icon:ie,endpoint:"/v1/services/report/widgets/network-utilization",category:"network"},{id:"client-count",title:"Connected Clients",description:"Total number of active client connections",unit:"clients",icon:ce,endpoint:"/v1/services/report/widgets/client-count",category:"clients"},{id:"ap-health",title:"Access Point Health",description:"Overall health status of access points",unit:"%",icon:oe,endpoint:"/v1/services/report/widgets/ap-health",category:"infrastructure"},{id:"throughput",title:"Network Throughput",description:"Current data throughput across the network",unit:"Mbps",icon:le,endpoint:"/v1/services/report/widgets/throughput",category:"network"},{id:"signal-quality",title:"Signal Quality",description:"Average signal strength across all connections",unit:"dBm",icon:de,endpoint:"/v1/services/report/widgets/signal-quality",category:"radio"},{id:"security-events",title:"Security Events",description:"Number of security events in the last 24 hours",unit:"events",icon:ue,endpoint:"/v1/services/report/widgets/security-events",category:"security"},{id:"alerts-count",title:"Active Alerts",description:"Current number of unresolved alerts",unit:"alerts",icon:he,endpoint:"/v1/services/report/widgets/alerts-count",category:"monitoring"},{id:"performance-score",title:"Performance Score",description:"Overall network performance rating",unit:"/100",icon:me,endpoint:"/v1/services/report/widgets/performance-score",category:"analytics"}],H=async t=>{try{let r="N/A",o="healthy";switch(t.id){case"network-utilization":try{const s=await h.makeAuthenticatedRequest("/v1/stations",{method:"GET"},8e3);if(s.ok){const a=await s.json(),l=Array.isArray(a)?a:[],i=Math.min(Math.round(l.length/10),100);r=i,o=i>85?"critical":i>70?"warning":"healthy"}}catch{console.log("Failed to fetch network utilization data")}break;case"client-count":try{const s=await h.makeAuthenticatedRequest("/v1/stations",{method:"GET"},8e3);if(s.ok){const a=await s.json();r=(Array.isArray(a)?a:[]).length,o="healthy"}}catch{console.log("Failed to fetch client count")}break;case"ap-health":try{const s=await h.makeAuthenticatedRequest("/v1/aps",{method:"GET"},8e3);if(s.ok){const a=await s.json(),l=Array.isArray(a)?a:a.aps||a.accessPoints||[],i=l.length,n=l.filter(c=>{const u=c.status?.toLowerCase()||"";return u==="connected"||u==="online"||u==="up"}).length;i>0?(r=Math.round(n/i*100),o=r<85?"critical":r<95?"warning":"healthy"):(r=0,o="warning")}}catch{console.log("Failed to fetch AP health data")}break;case"throughput":try{const s=await h.makeAuthenticatedRequest("/v1/stations",{method:"GET"},8e3);if(s.ok){const a=await s.json(),l=Array.isArray(a)?a:[];let i=0;l.forEach(c=>{const u=c.inBytes||c.rxBytes||0,d=c.outBytes||c.txBytes||0;i+=u+d}),r=Math.round(i*8/(1024*1024*60)),o="healthy"}}catch{console.log("Failed to fetch throughput data")}break;case"signal-quality":try{const s=await h.makeAuthenticatedRequest("/v1/stations",{method:"GET"},8e3);if(s.ok){const a=await s.json(),i=(Array.isArray(a)?a:[]).map(n=>n.signalStrength||n.rss).filter(n=>n!=null&&n<0);if(i.length>0){const n=Math.round(i.reduce((c,u)=>c+u,0)/i.length);r=n,o=n<-70?"critical":n<-50?"warning":"healthy"}}}catch{console.log("Failed to fetch signal quality data")}break;case"security-events":try{let s=[];const a=["/v1/events?type=security","/v1/events?severity=critical","/v1/alerts?type=security","/v1/events","/v1/notifications"];for(const l of a)try{const i=await h.makeAuthenticatedRequest(l,{method:"GET"},8e3);if(i.ok){const n=await i.json(),c=Array.isArray(n)?n:n.events||n.notifications||[],u=Date.now()-1440*60*1e3;if(s=c.filter(d=>{const x=d.timestamp||d.time||d.createdAt||0,y=(d.type||"").toLowerCase(),Y=(d.category||"").toLowerCase(),J=(d.severity||"").toLowerCase(),v=(d.description||d.message||"").toLowerCase(),K=y.includes("security")||Y.includes("security")||J==="critical"||v.includes("security")||v.includes("intrusion")||v.includes("breach")||v.includes("unauthorized"),X=x>u;return K&&X}),s.length>0||l==="/v1/notifications")break}}catch{continue}r=s.length,o=r>5?"critical":r>2?"warning":"healthy"}catch{console.log("Failed to fetch security events")}break;case"alerts-count":try{const s=await h.makeAuthenticatedRequest("/v1/alerts",{method:"GET"},8e3);if(s.ok){const a=await s.json();r=(Array.isArray(a)?a:a.alerts||[]).filter(n=>n.status!=="resolved"&&n.status!=="cleared").length,o=r>3?"critical":r>1?"warning":"healthy"}}catch{console.log("Failed to fetch alerts count")}break;case"performance-score":try{const[s,a]=await Promise.all([h.makeAuthenticatedRequest("/v1/aps",{method:"GET"},8e3),h.makeAuthenticatedRequest("/v1/stations",{method:"GET"},8e3)]);let l=50,i=50;if(s.ok){const n=await s.json(),c=Array.isArray(n)?n:n.aps||[],u=c.length,d=c.filter(x=>{const y=x.status?.toLowerCase()||"";return y==="connected"||y==="online"}).length;u>0&&(l=Math.round(d/u*50))}if(a.ok){const n=await a.json(),c=Array.isArray(n)?n:[],u=c.filter(d=>{const x=d.signalStrength||d.rss;return x&&x>-60}).length;c.length>0&&(i=Math.round(u/c.length*50))}r=Math.min(l+i,100),o=r<70?"critical":r<85?"warning":"healthy"}catch{console.log("Failed to calculate performance score")}break;default:try{const s=await h.makeAuthenticatedRequest(t.endpoint,{method:"GET"},8e3);if(s.ok){const a=await s.json();r=a.value||a.count||a.total||"N/A",o=a.status||"healthy"}}catch{console.log(`Failed to fetch data for widget ${t.id}`)}}return{...t,value:r,status:o,lastUpdated:new Date}}catch(r){return console.error(`Error fetching widget data for ${t.id}:`,r),{...t,value:"Error",status:"critical",lastUpdated:new Date}}},A=async()=>{try{S(!0);const t=I.map(o=>H(o)),r=await Promise.all(t);U(r)}catch(t){console.log("SUPPRESSED_ANALYTICS_ERROR: Error loading report widgets:",t),B.error("Failed to load some widgets",{description:"Some report widgets may not be available."})}finally{S(!1)}},O=async()=>{R(!0),await A(),R(!1),B.success("Widgets refreshed")};m.useEffect(()=>{A();const t=setInterval(A,3e4);return()=>clearInterval(t)},[]);const E=g.filter(t=>{const r=t.title.toLowerCase().includes(j.toLowerCase())||t.description.toLowerCase().includes(j.toLowerCase()),o=w==="all"||t.category===w,s=N==="all"||t.status===N;return r&&o&&s}),_=t=>{switch(t){case"healthy":return"bg-status-healthy text-status-healthy";case"warning":return"bg-status-warning text-status-warning";case"critical":return"bg-status-critical text-status-critical";default:return"bg-muted text-muted-foreground"}},V=t=>{switch(t){case"up":return"↗️";case"down":return"↘️";default:return"→"}},$=["all",...Array.from(new Set(g.map(t=>t.category)))],Q=["all","healthy","warning","critical"];return C?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{children:e.jsx("p",{className:"text-muted-foreground",children:"Real-time analytics and monitoring widgets"})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Array.from({length:8}).map((t,r)=>e.jsxs(p,{className:"surface-2dp",children:[e.jsxs(b,{className:"pb-3",children:[e.jsx("div",{className:"h-4 bg-muted rounded animate-pulse mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded animate-pulse w-3/4"})]}),e.jsxs(f,{children:[e.jsx("div",{className:"h-8 bg-muted rounded animate-pulse mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded animate-pulse w-1/2"})]})]},r))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-headline-5 text-high-emphasis",children:"Analytics & Monitoring Hub"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time widgets and metrics from Extreme Platform ONE"})]}),e.jsxs(Z,{onClick:O,disabled:k,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[e.jsx(ae,{className:`h-4 w-4 ${k?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),e.jsx(p,{className:"surface-1dp",children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ee,{placeholder:"Search widgets...",value:j,onChange:t=>G(t.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(T,{value:w,onValueChange:M,children:[e.jsx(q,{className:"w-40",children:e.jsx(F,{placeholder:"Category"})}),e.jsx(P,{children:$.map(t=>e.jsx(D,{value:t,children:t==="all"?"All Categories":t.charAt(0).toUpperCase()+t.slice(1)},t))})]}),e.jsxs(T,{value:N,onValueChange:z,children:[e.jsx(q,{className:"w-32",children:e.jsx(F,{placeholder:"Status"})}),e.jsx(P,{children:Q.map(t=>e.jsx(D,{value:t,children:t==="all"?"All Status":t.charAt(0).toUpperCase()+t.slice(1)},t))})]})]})]})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:E.map(t=>{const r=t.icon;return e.jsxs(p,{className:"surface-2dp hover:surface-4dp transition-all duration-200",children:[e.jsxs(b,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(r,{className:"h-5 w-5 text-primary"}),e.jsx(L,{variant:"outline",className:_(t.status),children:t.status})]}),e.jsx(L,{variant:"secondary",className:"text-xs",children:t.category})]}),e.jsx(W,{className:"text-base",children:t.title}),e.jsx(te,{className:"text-sm",children:t.description})]}),e.jsx(f,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-baseline space-x-2",children:[e.jsx("span",{className:"text-2xl font-semibold text-foreground",children:typeof t.value=="number"?se(t.value):t.value}),t.unit&&e.jsx("span",{className:"text-sm text-muted-foreground",children:t.unit})]}),t.trend&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx("span",{children:V(t.trend.direction)}),e.jsxs("span",{className:t.trend.direction==="up"?"text-success":"text-destructive",children:[t.trend.percentage,"%"]}),e.jsx("span",{className:"text-muted-foreground",children:"vs last hour"})]}),t.lastUpdated&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Updated ",t.lastUpdated.toLocaleTimeString()]})]})})]},t.id)})}),E.length===0&&!C&&e.jsx(p,{className:"surface-1dp",children:e.jsxs(f,{className:"p-12 text-center",children:[e.jsx(ne,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No widgets found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search terms or filters to see more widgets."})]})}),e.jsxs(p,{className:"surface-1dp",children:[e.jsx(b,{children:e.jsx(W,{className:"text-lg",children:"Widget Summary"})}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-semibold text-foreground",children:g.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Widgets"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-semibold text-success",children:g.filter(t=>t.status==="healthy").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Healthy"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-semibold text-warning",children:g.filter(t=>t.status==="warning").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Warning"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-semibold text-destructive",children:g.filter(t=>t.status==="critical").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Critical"})]})]})})]})]})}export{je as ReportWidgets};
