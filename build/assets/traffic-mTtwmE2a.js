import{a as f}from"./index-CrdvL8SR.js";class o{async getStationTrafficStats(r){try{const a=await f.makeAuthenticatedRequest(`/v1/stations/${encodeURIComponent(r)}`);if(!a.ok)throw new Error(`Failed to fetch station traffic stats: ${a.status} ${a.statusText}`);return await a.json()}catch(a){return console.warn(`Traffic stats unavailable for ${r}:`,a),null}}async loadTrafficStatisticsForStations(r,a=100,e=0){const c=new Map;try{console.log(`[TrafficService] Loading traffic stats for ${r.length} stations (limit: ${a}, offset: ${e})`);const i=["macAddress","inBytes","outBytes","rxBytes","txBytes","packets","outPackets","rss","signalStrength"];return(await f.getStations({fields:i,limit:a,offset:e})).forEach(t=>{t.macAddress&&c.set(t.macAddress,{macAddress:t.macAddress,inBytes:t.inBytes||t.rxBytes||0,outBytes:t.outBytes||t.txBytes||0,rxBytes:t.rxBytes||t.inBytes||0,txBytes:t.txBytes||t.outBytes||0,packets:t.packets||0,outPackets:t.outPackets||0,rss:t.rss||t.signalStrength,signalStrength:t.signalStrength||t.rss})}),console.log(`[TrafficService] Successfully loaded traffic stats for ${c.size} stations`),c}catch(i){return console.warn("[TrafficService] Error loading traffic statistics, falling back to individual queries:",i),this.loadTrafficStatisticsFallback(r,Math.min(a,20))}}async loadTrafficStatisticsFallback(r,a=20){const e=new Map,c=r.slice(0,a);console.log(`[TrafficService] Using fallback N+1 pattern for ${c.length} stations`);const i=c.map(async s=>{try{const t=await this.getStationTrafficStats(s.macAddress);return{macAddress:s.macAddress,data:t}}catch(t){return console.warn(`Failed to load traffic for ${s.macAddress}:`,t),{macAddress:s.macAddress,data:null}}});try{return(await Promise.allSettled(i)).forEach(t=>{t.status==="fulfilled"&&t.value.data&&e.set(t.value.macAddress,t.value.data)}),e}catch(s){return console.warn("Error loading traffic statistics:",s),e}}}const d=new o;export{d as t};
