import{j as e}from"./vendor-ui-CO0mBmim.js";import{a as o}from"./vendor-react-BQC692LR.js";import{a as h,w as x,t as p,B as y,C as r,b as i,c as n,d as c,h as w,m as M,n as E,o as U,p as z,q as j,e as t}from"./index-CrdvL8SR.js";import{S as v,R as H,bD as b,W as S,y as V,a3 as C,aq as q,x as A}from"./vendor-icons-DmoIqCnf.js";import"./vendor-charts-CCS-1Xlq.js";function G(){const[l,R]=o.useState([]),[u,P]=o.useState([]),[k,g]=o.useState(!0),[f,N]=o.useState(!1);o.useEffect(()=>{m()},[]);const m=async()=>{g(!0);try{const[s,a]=await Promise.all([h.getRogueAPList(),h.getSecurityThreats()]);R(s),P(a)}catch(s){console.error("Failed to load security data:",s),x.error("Failed to load security information")}finally{g(!1)}},F=async()=>{N(!0);try{await h.detectRogueAPs(),x.success("Rogue AP scan initiated"),setTimeout(m,3e3)}catch(s){console.error("Failed to initiate scan:",s),x.error("Failed to start rogue AP scan")}finally{N(!1)}},D=async(s,a)=>{try{await h.classifyRogueAP(s,a),x.success(`Rogue AP classified as ${a}`),await m()}catch(B){console.error("Failed to classify rogue AP:",B),x.error("Failed to classify rogue AP")}},L=s=>{switch(s?.toLowerCase()){case"malicious":return e.jsx(t,{variant:"destructive",children:"Malicious"});case"friendly":return e.jsx(t,{className:"bg-green-500",children:"Friendly"});default:return e.jsx(t,{variant:"outline",children:"Unknown"})}},T=s=>{switch(s?.toLowerCase()){case"critical":return e.jsx(t,{variant:"destructive",children:"Critical"});case"high":return e.jsx(t,{className:"bg-orange-500",children:"High"});case"medium":return e.jsx(t,{className:"bg-yellow-500",children:"Medium"});case"low":return e.jsx(t,{variant:"secondary",children:"Low"});default:return e.jsx(t,{variant:"outline",children:s})}},d={totalRogueAPs:l.length,malicious:l.filter(s=>s.classification?.toLowerCase()==="malicious").length,friendly:l.filter(s=>s.classification?.toLowerCase()==="friendly").length,unknown:l.filter(s=>!s.classification||s.classification?.toLowerCase()==="unknown").length,threats:u.length};return k?e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsx(p,{className:"h-8 w-64"}),e.jsx(p,{className:"h-96 w-full"})]}):e.jsxs("div",{className:"space-y-6 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(v,{className:"h-6 w-6"}),"Security Dashboard"]}),e.jsx("p",{className:"text-muted-foreground",children:"Rogue AP detection and security threat monitoring"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{variant:"outline",size:"sm",onClick:m,"aria-label":"Refresh security data",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsx(y,{size:"sm",onClick:F,disabled:f,"aria-label":"Scan for rogue access points",children:f?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2 animate-pulse"}),"Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Scan for Rogue APs"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs(r,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Rogue APs"})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"text-2xl font-bold",children:d.totalRogueAPs})]})})]}),e.jsxs(r,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Malicious"})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{className:"text-2xl font-bold",children:d.malicious})]})})]}),e.jsxs(r,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Friendly"})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-2xl font-bold",children:d.friendly})]})})]}),e.jsxs(r,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Unknown"})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{className:"text-2xl font-bold",children:d.unknown})]})})]}),e.jsxs(r,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Threats"})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-orange-500"}),e.jsx("span",{className:"text-2xl font-bold",children:d.threats})]})})]})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(n,{children:"Detected Rogue Access Points"}),e.jsx(w,{children:"Unauthorized access points detected in the wireless environment"})]}),e.jsx(c,{children:l.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(v,{className:"h-12 w-12 mx-auto mb-4 opacity-50 text-green-500"}),e.jsx("p",{children:"No rogue access points detected"}),e.jsx("p",{className:"text-sm mt-2",children:"Your wireless environment is secure"})]}):e.jsx("div",{className:"space-y-2",children:l.map(s=>e.jsxs("div",{className:"flex items-start justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(S,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold",children:s.ssid||"Hidden SSID"}),L(s.classification)]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["MAC: ",s.macAddress]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[s.channel&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Channel:"})," ",e.jsx("span",{className:"font-medium",children:s.channel})]}),s.signal&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Signal:"})," ",e.jsxs("span",{className:"font-medium",children:[s.signal," dBm"]})]})]})]})]}),e.jsx("div",{children:e.jsxs(M,{defaultValue:s.classification||"unknown",onValueChange:a=>D(s.macAddress,a),children:[e.jsx(E,{className:"w-32",children:e.jsx(U,{})}),e.jsxs(z,{children:[e.jsx(j,{value:"friendly",children:"Friendly"}),e.jsx(j,{value:"malicious",children:"Malicious"}),e.jsx(j,{value:"unknown",children:"Unknown"})]})]})})]},s.macAddress))})})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsx(n,{children:"Security Threats"}),e.jsx(w,{children:"Detected security threats and anomalies"})]}),e.jsx(c,{children:u.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(C,{className:"h-12 w-12 mx-auto mb-4 opacity-50 text-green-500"}),e.jsx("p",{children:"No security threats detected"})]}):e.jsx("div",{className:"space-y-2",children:u.map((s,a)=>e.jsxs("div",{className:"flex items-start gap-3 p-4 border rounded-lg",children:[e.jsx(A,{className:"h-5 w-5 text-orange-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold",children:s.type||"Security Threat"}),T(s.severity)]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.description||s.message}),s.affectedDevices&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Affected devices: ",s.affectedDevices.join(", ")]})]})]},a))})})]})]})}export{G as SecurityDashboard};
