import{j as e}from"./vendor-ui-CO0mBmim.js";import{a as n}from"./vendor-react-BQC692LR.js";import{a as T,w as G,t as j,C as d,b as x,d as o,B as k,A as F,l as E,c as h,T as q,i as z,j as y,k as b,h as A,e as a,L as m}from"./index-CrdvL8SR.js";import{T as D,a as O,b as g,c as i,d as I,e as c}from"./table-BR47Ry2r.js";import{R as V,W as v,S as w,a_ as p,a3 as K,y as X,a$ as _,I as $}from"./vendor-icons-DmoIqCnf.js";import"./vendor-charts-CCS-1Xlq.js";function ce(){const[W,C]=n.useState(!0),[f,L]=n.useState([]),[l,M]=n.useState([]),[U,B]=n.useState("networks"),[S,P]=n.useState(""),[J,Q]=n.useState(!1),[Y,Z]=n.useState({ssid:"",vlan:"",maxDuration:"24",requiresApproval:!1,enableCaptivePortal:!0});n.useEffect(()=>{R()},[]);const R=async()=>{C(!0),P("");try{const[s,r]=await Promise.allSettled([T.getServices(),T.getRoles()]);if(s.status==="fulfilled"){const u=(Array.isArray(s.value)?s.value:[]).filter(t=>t.guestAccess===!0||t.captivePortal===!0||t.enableCaptivePortal===!0||t.serviceName?.toLowerCase().includes("guest"));L(u)}if(r.status==="fulfilled"){const u=(Array.isArray(r.value)?r.value:[]).filter(t=>t.name?.toLowerCase().includes("guest")||t.cpTopologyId!==null||t.cpRedirect!=="");M(u)}}catch(s){const r=s instanceof Error?s.message:"Failed to load guest configuration";P(r),G.error("Failed to load guest data",{description:r})}finally{C(!1)}},H=async()=>{await R(),G.success("Guest data refreshed")};return W?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(j,{className:"h-8 w-48 mb-2"}),e.jsx(j,{className:"h-4 w-96"})]}),e.jsx(j,{className:"h-10 w-24"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:[1,2,3].map(s=>e.jsxs(d,{children:[e.jsx(x,{className:"pb-3",children:e.jsx(j,{className:"h-5 w-32"})}),e.jsx(o,{children:e.jsx(j,{className:"h-8 w-16"})})]},s))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl tracking-tight",children:"Guest Access Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure guest networks, access policies, and captive portal settings"})]}),e.jsxs(k,{onClick:H,variant:"outline",size:"sm",children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"Refresh"]})]}),S&&e.jsx(F,{variant:"destructive",children:e.jsx(E,{children:S})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(d,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm",children:"Guest Networks"}),e.jsx(v,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl",children:f.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active guest SSIDs"})]})]}),e.jsxs(d,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm",children:"Guest Roles"}),e.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl",children:l.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Configured access policies"})]})]}),e.jsxs(d,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm",children:"Captive Portal"}),e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl",children:f.filter(s=>s.captivePortal||s.enableCaptivePortal).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Networks with portal"})]})]})]}),e.jsxs(q,{value:U,onValueChange:B,className:"space-y-4",children:[e.jsxs(z,{children:[e.jsxs(y,{value:"networks",children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Guest Networks"]}),e.jsxs(y,{value:"policies",children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Access Policies"]}),e.jsxs(y,{value:"settings",children:[e.jsx(p,{className:"mr-2 h-4 w-4"}),"Captive Portal"]})]}),e.jsx(b,{value:"networks",className:"space-y-4",children:e.jsxs(d,{children:[e.jsx(x,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(h,{children:"Guest Network Configuration"}),e.jsx(A,{children:"Manage SSIDs and network settings for guest access"})]})})}),e.jsx(o,{children:f.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(v,{className:"mx-auto h-12 w-12 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"mt-4 text-lg",children:"No guest networks configured"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Configure a network with guest access enabled in the Networks section"})]}):e.jsxs(D,{children:[e.jsx(O,{children:e.jsxs(g,{children:[e.jsx(i,{children:"SSID / Service Name"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Security"}),e.jsx(i,{children:"VLAN"}),e.jsx(i,{children:"Captive Portal"}),e.jsx(i,{className:"text-right",children:"Actions"})]})}),e.jsx(I,{children:f.map(s=>{const r=s.ssid||s.serviceName||s.name||"Unknown",N=s.enabled!==!1&&s.status!=="disabled",u=s.captivePortal||s.enableCaptivePortal;let t="Open";return s.WpaPskElement||s.privacy?.WpaPskElement?t="WPA/WPA2 PSK":s.WpaEnterpriseElement||s.privacy?.WpaEnterpriseElement?t="WPA Enterprise":(s.WpaSaeElement||s.privacy?.WpaSaeElement)&&(t="WPA3 SAE"),e.jsxs(g,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:r})]})}),e.jsx(c,{children:e.jsx(a,{variant:N?"default":"secondary",children:N?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"mr-1 h-3 w-3"}),"Enabled"]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"mr-1 h-3 w-3"}),"Disabled"]})})}),e.jsx(c,{children:e.jsx(a,{variant:"outline",children:t})}),e.jsx(c,{children:s.vlan||s.dot1dPortNumber||"Default"}),e.jsx(c,{children:u?e.jsxs(a,{variant:"default",children:[e.jsx(p,{className:"mr-1 h-3 w-3"}),"Active"]}):e.jsx(a,{variant:"secondary",children:"Not configured"})}),e.jsx(c,{className:"text-right",children:e.jsx(k,{variant:"ghost",size:"sm",children:e.jsx(_,{className:"h-4 w-4"})})})]},s.id)})})]})})]})}),e.jsx(b,{value:"policies",className:"space-y-4",children:e.jsxs(d,{children:[e.jsxs(x,{children:[e.jsx(h,{children:"Guest Access Policies"}),e.jsx(A,{children:"Roles and firewall policies for guest users"})]}),e.jsx(o,{children:l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"mx-auto h-12 w-12 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"mt-4 text-lg",children:"No guest policies configured"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Create a role with guest-specific access policies in the Policy section"})]}):e.jsxs(D,{children:[e.jsx(O,{children:e.jsxs(g,{children:[e.jsx(i,{children:"Role Name"}),e.jsx(i,{children:"Default Action"}),e.jsx(i,{children:"Captive Portal"}),e.jsx(i,{children:"Features"}),e.jsx(i,{className:"text-right",children:"Filters"})]})}),e.jsx(I,{children:l.map(s=>e.jsxs(g,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.name}),s.predefined&&e.jsx(a,{variant:"secondary",className:"text-xs",children:"Built-in"})]})}),e.jsx(c,{children:e.jsx(a,{variant:s.defaultAction==="allow"?"default":"destructive",children:s.defaultAction||"N/A"})}),e.jsx(c,{children:s.cpRedirect?e.jsxs(a,{variant:"default",children:[e.jsx(p,{className:"mr-1 h-3 w-3"}),s.cpRedirect]}):e.jsx(a,{variant:"secondary",children:"No redirect"})}),e.jsx(c,{children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.cpHttp&&e.jsx(a,{variant:"outline",className:"text-xs",children:"HTTP"}),s.cpOauthUseGoogle&&e.jsx(a,{variant:"outline",className:"text-xs",children:"Google OAuth"}),s.cpOauthUseFacebook&&e.jsx(a,{variant:"outline",className:"text-xs",children:"Facebook OAuth"}),!s.cpHttp&&!s.cpOauthUseGoogle&&!s.cpOauthUseFacebook&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"None"})]})}),e.jsx(c,{className:"text-right",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["L2: ",s.l2Filters?.length||0," | L3: ",s.l3Filters?.length||0," | L7: ",s.l7Filters?.length||0]})})]},s.id))})]})})]})}),e.jsx(b,{value:"settings",className:"space-y-4",children:e.jsxs(d,{children:[e.jsxs(x,{children:[e.jsx(h,{children:"Captive Portal Configuration"}),e.jsx(A,{children:"Manage captive portal settings and authentication options"})]}),e.jsxs(o,{className:"space-y-6",children:[e.jsxs(F,{children:[e.jsx($,{className:"h-4 w-4"}),e.jsx(E,{children:"Captive portal settings are configured per role. Networks with guest access should be assigned to roles with captive portal configuration enabled."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Portal Features"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"oauth-google",className:"text-sm",children:"Google OAuth"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[l.filter(s=>s.cpOauthUseGoogle).length," role(s)"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"oauth-facebook",className:"text-sm",children:"Facebook OAuth"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[l.filter(s=>s.cpOauthUseFacebook).length," role(s)"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"oauth-microsoft",className:"text-sm",children:"Microsoft OAuth"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[l.filter(s=>s.cpOauthUseMicrosoft).length," role(s)"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Portal Parameters"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{className:"text-sm",children:"Include AP Name"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[l.filter(s=>s.cpAddApNameAndSerial).length," role(s)"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{className:"text-sm",children:"Include MAC Address"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[l.filter(s=>s.cpAddMac).length," role(s)"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{className:"text-sm",children:"Include SSID"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[l.filter(s=>s.cpAddSsid).length," role(s)"]})]})]})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Active Captive Portal Roles"}),l.filter(s=>s.cpRedirect).length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No roles with captive portal redirect configured"}):e.jsx("div",{className:"space-y-2",children:l.filter(s=>s.cpRedirect).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Redirect: ",s.cpRedirect]})]})]}),e.jsx(a,{variant:"outline",children:s.cpIdentity||"No identity"})]},s.id))})]})]})]})]})})]})]})}export{ce as ConfigureGuest};
