import{j as e}from"./vendor-ui-CO0mBmim.js";import{a as s}from"./vendor-react-BQC692LR.js";import{a as n,w as r,t as q,C as v,b as k,c as C,d as F,h as G,e as D,B as i,L as ne,I as ie}from"./index-CrdvL8SR.js";import{D as B,a as S,b as R,c as E,d as $,e as O}from"./dialog-BqYeg193.js";import{D as oe,T as g}from"./MobileOptimized-BTJ5PvfS.js";import{D as j,H as z,x as W,R as b,av as ce,a1 as de,b as me,a0 as Z,a3 as ue}from"./vendor-icons-DmoIqCnf.js";import"./vendor-charts-CCS-1Xlq.js";function we(){const[T,_]=s.useState([]),[U,J]=s.useState([]),[t,Q]=s.useState(null),[V,L]=s.useState(!0),[w,P]=s.useState(!1),[m,M]=s.useState(""),[X,u]=s.useState(!1),[Y,h]=s.useState(!1),[x,A]=s.useState(null),[ee,p]=s.useState(!1),[f,N]=s.useState(null);s.useEffect(()=>{y(),H()},[]);const y=async()=>{L(!0);try{const a=await n.getConfigurationBackups();_(a)}catch(a){console.error("Failed to load backups:",a),r.error("Failed to load configuration backups")}finally{L(!1)}},H=async()=>{try{const[a,l]=await Promise.all([n.getFlashFiles(),n.getFlashUsage()]);J(a),Q(l)}catch(a){console.error("Failed to load flash info:",a)}},ae=a=>/^[a-zA-Z0-9\-_.]+$/.test(a),I=async()=>{if(!m.trim()){r.error("Please enter a backup filename");return}if(!ae(m)){r.error("Filename can only contain letters, numbers, hyphens, underscores, and dots");return}P(!0);try{await n.createConfigurationBackup(m),r.success("Configuration backup created successfully"),u(!1),M(""),await y()}catch(a){console.error("Failed to create backup:",a),r.error("Failed to create configuration backup")}finally{P(!1)}},se=async a=>{try{const l=await n.downloadConfigurationBackup(a),K=window.URL.createObjectURL(l),d=document.createElement("a");d.href=K,d.download=a,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(K),document.body.removeChild(d),r.success("Backup downloaded successfully")}catch(l){console.error("Failed to download backup:",l),r.error("Failed to download backup file")}},re=async()=>{if(x)try{await n.restoreConfiguration(x),r.success("Configuration restored successfully"),h(!1),A(null)}catch(a){console.error("Failed to restore backup:",a),r.error("Failed to restore configuration")}},le=async()=>{if(f)try{await n.deleteFlashFile(f),r.success("File deleted successfully"),p(!1),N(null),await H()}catch(a){console.error("Failed to delete file:",a),r.error("Failed to delete file")}},c=a=>a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(2)} KB`:a<1024*1024*1024?`${(a/(1024*1024)).toFixed(2)} MB`:`${(a/(1024*1024*1024)).toFixed(2)} GB`,te=a=>{try{return new Date(a).toLocaleString()}catch{return a}},o=()=>!t?.total||!t?.used?0:t.used/t.total*100;return V?e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsx(q,{className:"h-8 w-64"}),e.jsx(q,{className:"h-96 w-full"})]}):e.jsxs("div",{className:"space-y-6 p-4 md:p-6 animate-in fade-in duration-500",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl md:text-3xl font-bold flex items-center gap-3 bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent",children:[e.jsx(j,{className:"h-6 w-6 md:h-8 md:w-8 text-primary"}),"System Backup & Storage Manager"]}),e.jsx(oe,{children:e.jsx("p",{className:"text-muted-foreground mt-2 text-base",children:"Manage configuration backups and flash memory storage"})})]})}),t&&e.jsxs(v,{className:"border-2 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsx(k,{className:"pb-4",children:e.jsxs(C,{className:"flex items-center gap-2 text-xl",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(z,{className:"h-5 w-5 text-primary"})}),"Flash Memory Usage"]})}),e.jsx(F,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-muted/30 to-muted/10 p-4 rounded-xl",children:[e.jsxs("div",{className:"flex justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Storage Capacity"}),e.jsxs("span",{className:"text-sm font-mono font-medium",children:[c(t.used)," / ",c(t.total)]})]}),e.jsx("div",{className:"w-full bg-muted/50 rounded-full h-3 overflow-hidden shadow-inner",role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":o(),"aria-label":"Flash memory usage",children:e.jsx("div",{className:`h-3 rounded-full transition-all duration-700 ease-out shadow-sm ${o()>90?"bg-gradient-to-r from-red-500 to-red-600":o()>70?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-green-500 to-emerald-500"}`,style:{width:`${o()}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsxs("p",{className:"text-xs font-medium text-muted-foreground",children:[o().toFixed(1),"% utilized"]}),e.jsxs("p",{className:"text-xs font-medium text-muted-foreground",children:[c(t.total-t.used)," available"]})]})]}),o()>80&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md",children:[e.jsx(W,{className:"h-4 w-4 text-yellow-600"}),e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Storage is running low. Consider deleting old backup files."})]})]})})]}),e.jsxs(v,{className:"border-2 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsx(k,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(C,{className:"text-xl flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-blue-600"})}),"Configuration Backups"]}),e.jsx(G,{className:"mt-1",children:"Backup and restore Extreme Platform ONE configuration"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:y,"aria-label":"Refresh backup list",className:"hover:bg-muted/80 transition-colors shadow-sm",children:[e.jsx(b,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Refresh"})]}),e.jsxs(g,{size:"sm",onClick:()=>u(!0),"aria-label":"Create new configuration backup",className:"shadow-md hover:shadow-lg transition-all bg-gradient-to-r from-primary to-primary/90",children:[e.jsx(ce,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Create Backup"})]})]})]})}),e.jsx(F,{children:T.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"inline-block p-6 bg-gradient-to-br from-blue-50 to-blue-100/50 rounded-2xl mb-4",children:e.jsx(j,{className:"h-16 w-16 mx-auto text-blue-500/60"})}),e.jsx("p",{className:"text-lg font-semibold mb-2",children:"No configuration backups found"}),e.jsx("p",{className:"text-sm max-w-md mx-auto",children:"Create your first backup to safeguard your Extreme Platform ONE configuration and enable quick restore capabilities"})]}):e.jsx("div",{className:"space-y-3",children:T.map((a,l)=>e.jsxs("div",{className:"group flex items-center justify-between p-4 border-2 rounded-xl hover:border-primary/50 hover:bg-primary/5 transition-all duration-300 hover:shadow-md",style:{animationDelay:`${l*50}ms`},children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-500/10 rounded-lg group-hover:bg-blue-500/20 transition-colors",children:e.jsx(j,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-base group-hover:text-primary transition-colors",children:a.filename}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(de,{className:"h-3.5 w-3.5"}),te(a.created)]}),e.jsx(D,{variant:"outline",className:"font-mono text-xs",children:c(a.size)})]})]})]}),e.jsxs("div",{className:"flex gap-2 opacity-100 group-hover:opacity-100 transition-opacity",children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>se(a.filename),"aria-label":`Download backup ${a.filename}`,className:"hover:bg-green-50 hover:text-green-700 hover:border-green-300 transition-colors",children:[e.jsx(me,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Download"})]}),e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>{A(a.filename),h(!0)},"aria-label":`Restore configuration from ${a.filename}`,className:"hover:bg-blue-50 hover:text-blue-700 hover:border-blue-300 transition-colors",children:[e.jsx(b,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Restore"})]})]})]},a.filename))})})]}),e.jsxs(v,{className:"border-2 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsxs(k,{className:"pb-4",children:[e.jsxs(C,{className:"text-xl flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg",children:e.jsx(z,{className:"h-5 w-5 text-purple-600"})}),"Flash Memory Files"]}),e.jsx(G,{className:"mt-1",children:"Manage files stored in flash memory"})]}),e.jsx(F,{children:U.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{children:"No files found in flash memory"})}):e.jsx("div",{className:"space-y-2",children:U.map((a,l)=>e.jsxs("div",{className:"group flex items-center justify-between p-4 border-2 rounded-xl hover:border-purple-300 hover:bg-purple-50/50 transition-all duration-300",style:{animationDelay:`${l*50}ms`},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg group-hover:bg-purple-200 transition-colors",children:e.jsx(z,{className:"h-4 w-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:a.filename}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(D,{variant:"outline",className:"text-xs font-mono",children:c(a.size)}),a.type&&e.jsx(D,{variant:"secondary",className:"text-xs",children:a.type})]})]})]}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>{N(a.filename),p(!0)},"aria-label":`Delete file ${a.filename}`,className:"hover:bg-red-50 hover:text-red-700 transition-colors",children:e.jsx(Z,{className:"h-4 w-4"})})]},a.filename))})})]}),e.jsx(B,{open:X,onOpenChange:u,children:e.jsxs(S,{children:[e.jsxs(R,{children:[e.jsx(E,{children:"Create Configuration Backup"}),e.jsx($,{children:"Enter a name for the backup file. A timestamp will be added automatically."})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(ne,{htmlFor:"backup-filename",children:"Backup Filename"}),e.jsx(ie,{id:"backup-filename",value:m,onChange:a=>M(a.target.value),placeholder:"config-backup",onKeyPress:a=>a.key==="Enter"&&I(),"aria-describedby":"backup-filename-hint","aria-label":"Enter backup filename"}),e.jsx("p",{id:"backup-filename-hint",className:"text-xs text-muted-foreground",children:"Only letters, numbers, hyphens, underscores, and dots are allowed"})]})}),e.jsxs(O,{children:[e.jsx(i,{variant:"outline",onClick:()=>u(!1),disabled:w,"aria-label":"Cancel backup creation",children:"Cancel"}),e.jsx(i,{onClick:I,disabled:w,"aria-label":"Create configuration backup",children:w?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Create Backup"]})})]})]})}),e.jsx(B,{open:Y,onOpenChange:h,children:e.jsxs(S,{children:[e.jsxs(R,{children:[e.jsx(E,{children:"Restore Configuration"}),e.jsx($,{children:"Are you sure you want to restore from this backup? Extreme Platform ONE will be restarted and current configuration will be replaced."})]}),e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md",children:[e.jsx(W,{className:"h-4 w-4 text-yellow-600"}),e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{children:"Warning:"})," This action will restart Extreme Platform ONE and may cause temporary service disruption."]})]}),x&&e.jsxs("p",{className:"mt-4 text-sm",children:[e.jsx("strong",{children:"Selected backup:"})," ",x]})]}),e.jsxs(O,{children:[e.jsx(i,{variant:"outline",onClick:()=>h(!1),"aria-label":"Cancel restore operation",children:"Cancel"}),e.jsxs(i,{variant:"destructive",onClick:re,"aria-label":"Confirm restore configuration",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Restore Configuration"]})]})]})}),e.jsx(B,{open:ee,onOpenChange:p,children:e.jsxs(S,{children:[e.jsxs(R,{children:[e.jsx(E,{children:"Delete Flash File"}),e.jsx($,{children:"Are you sure you want to delete this file? This action cannot be undone."})]}),e.jsx("div",{className:"py-4",children:f&&e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"File to delete:"})," ",f]})}),e.jsxs(O,{children:[e.jsx(i,{variant:"outline",onClick:()=>{p(!1),N(null)},"aria-label":"Cancel delete operation",children:"Cancel"}),e.jsxs(i,{variant:"destructive",onClick:le,"aria-label":"Confirm delete file",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Delete File"]})]})]})})]})}export{we as SystemBackupManager};
