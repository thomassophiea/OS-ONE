import{j as e}from"./vendor-ui-CO0mBmim.js";import{a as f}from"./vendor-react-BQC692LR.js";import{w as x,C as H,t as B,L as l,m as J,n as Q,o as W,p as Z,q as N,e as y,B as j,T as we,i as Se,j as _,k as V,I as p}from"./index-CrdvL8SR.js";import{S as F}from"./switch-iy-vimzq.js";import{T as $,a as Y,b as D,c as m,d as K,e as u}from"./table-BR47Ry2r.js";import{D as ee,a as se,b as ae,c as re,d as te,e as ie}from"./dialog-BqYeg193.js";import{S as Ae,w as k,y as L,am as le,D as ce,b1 as de,ac as q,b3 as X,a0 as G}from"./vendor-icons-DmoIqCnf.js";import"./vendor-charts-CCS-1Xlq.js";function He(){const[v,g]=f.useState(!0),[a,w]=f.useState({authenticationMethod:"RADIUS",authenticateLocallyForMac:!0,fallbackToLocal:!0}),[i,t]=f.useState([]),[n,r]=f.useState(!1),[b,d]=f.useState(null),[h,T]=f.useState([]),[oe,P]=f.useState(!1),[M,E]=f.useState(null),[ne,I]=f.useState([]),[he,R]=f.useState(!1),[O,z]=f.useState(null);f.useEffect(()=>{me()},[]);const me=async()=>{g(!0);try{await new Promise(s=>setTimeout(s,800)),t([{id:"1",name:"Primary RADIUS",ipAddress:"192.168.100.1",port:1812,sharedSecret:"••••••••",timeout:5,retries:3,isPrimary:!0,status:"active"}]),T([]),I([{id:"1",enabled:!0,username:"admin",displayName:"System Administrator",firstName:"System",lastName:"Administrator",passwordHashType:"SHA-256",password:"••••••••",description:"Primary administrator account",lastLogin:new Date(Date.now()-36e5).toISOString(),createdAt:new Date(Date.now()-864e5*30).toISOString()},{id:"2",enabled:!0,username:"network_ops",displayName:"Network Operations",firstName:"Network",lastName:"Operations",passwordHashType:"SHA-256",password:"••••••••",description:"Network operations team account",lastLogin:new Date(Date.now()-72e5).toISOString(),createdAt:new Date(Date.now()-864e5*15).toISOString()}])}catch(s){console.error("Error loading AAA configuration:",s),x.error("Failed to load AAA configuration")}finally{g(!1)}},ue=async()=>{try{await new Promise(s=>setTimeout(s,500)),x.success("AAA configuration saved successfully")}catch{x.error("Failed to save AAA configuration")}},xe=async s=>{try{if(b)t(c=>c.map(o=>o.id===b.id?{...o,...s}:o)),x.success("RADIUS server updated successfully");else{const c={id:Date.now().toString(),status:"active",...s};t(o=>[...o,c]),x.success("RADIUS server added successfully")}r(!1),d(null)}catch{x.error("Failed to save RADIUS server")}},je=async s=>{if(confirm("Are you sure you want to delete this RADIUS server?"))try{t(c=>c.filter(o=>o.id!==s)),x.success("RADIUS server deleted successfully")}catch{x.error("Failed to delete RADIUS server")}},pe=async s=>{try{if(M)T(c=>c.map(o=>o.id===M.id?{...o,...s}:o)),x.success("LDAP configuration updated successfully");else{const c={id:Date.now().toString(),status:"disconnected",...s};T(o=>[...o,c]),x.success("LDAP configuration added successfully")}P(!1),E(null)}catch{x.error("Failed to save LDAP configuration")}},fe=async s=>{if(confirm("Are you sure you want to delete this LDAP configuration?"))try{T(c=>c.filter(o=>o.id!==s)),x.success("LDAP configuration deleted successfully")}catch{x.error("Failed to delete LDAP configuration")}},Ne=async s=>{try{if(O)I(c=>c.map(o=>o.id===O.id?{...o,...s}:o)),x.success("User updated successfully");else{const c={id:Date.now().toString(),status:"active",createdAt:new Date().toISOString(),...s};I(o=>[...o,c]),x.success("User created successfully")}R(!1),z(null)}catch{x.error("Failed to save user")}},ge=async s=>{if(confirm("Are you sure you want to delete this user?"))try{I(c=>c.filter(o=>o.id!==s)),x.success("User deleted successfully")}catch{x.error("Failed to delete user")}},ve=s=>{if(!s)return"Never";const c=new Date(s),ye=new Date().getTime()-c.getTime(),U=Math.floor(ye/6e4);return U<60?`${U}m ago`:U<1440?`${Math.floor(U/60)}h ago`:`${Math.floor(U/1440)}d ago`},S=i.find(s=>s.id===a.primaryRadiusId||s.isPrimary),A=i.find(s=>s.id===a.backupRadiusId),C=h.find(s=>s.id===a.ldapConfigId);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{children:e.jsx("p",{className:"text-muted-foreground",children:"Configure authentication, authorization, and accounting policies"})})}),e.jsxs(H,{className:"surface-2dp border-border",children:[e.jsx("div",{className:"p-6 border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-medium",children:"Default AAA Configuration"})]})}),v?e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(B,{className:"h-12 w-full"}),e.jsx(B,{className:"h-12 w-full"}),e.jsx(B,{className:"h-12 w-full"})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-[200px_1fr] gap-4 items-center border-b border-border pb-3",children:[e.jsx(l,{className:"font-medium",children:"Authentication Method"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(J,{value:a.authenticationMethod,onValueChange:s=>w(c=>({...c,authenticationMethod:s})),children:[e.jsx(Q,{className:"w-[200px]",children:e.jsx(W,{})}),e.jsxs(Z,{children:[e.jsx(N,{value:"RADIUS",children:"RADIUS"}),e.jsx(N,{value:"LDAP",children:"LDAP"}),e.jsx(N,{value:"LOCAL",children:"Local"}),e.jsx(N,{value:"HYBRID",children:"Hybrid"})]})]}),e.jsx(y,{variant:"secondary",children:a.authenticationMethod})]})]}),e.jsxs("div",{className:"grid grid-cols-[200px_1fr] gap-4 items-center border-b border-border pb-3",children:[e.jsx(l,{className:"font-medium",children:"Primary RADIUS"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-foreground",children:S?S.ipAddress:"Not configured"}),S&&e.jsxs(y,{variant:S.status==="active"?"default":"secondary",className:"flex items-center gap-1",children:[S.status==="active"?e.jsx(k,{className:"h-3 w-3"}):e.jsx(L,{className:"h-3 w-3"}),S.status]})]})]}),e.jsxs("div",{className:"grid grid-cols-[200px_1fr] gap-4 items-center border-b border-border pb-3",children:[e.jsx(l,{className:"font-medium",children:"Backup RADIUS"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-foreground",children:A?A.ipAddress:"OFF"}),A&&e.jsxs(y,{variant:A.status==="active"?"default":"secondary",className:"flex items-center gap-1",children:[A.status==="active"?e.jsx(k,{className:"h-3 w-3"}):e.jsx(L,{className:"h-3 w-3"}),A.status]})]})]}),e.jsxs("div",{className:"grid grid-cols-[200px_1fr] gap-4 items-center border-b border-border pb-3",children:[e.jsx(l,{className:"font-medium",children:"LDAP Configuration"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-foreground",children:C?C.configurationName:"OFF"}),C&&e.jsxs(y,{variant:C.status==="connected"?"default":"secondary",className:"flex items-center gap-1",children:[C.status==="connected"?e.jsx(k,{className:"h-3 w-3"}):e.jsx(L,{className:"h-3 w-3"}),C.status]})]})]}),e.jsxs("div",{className:"grid grid-cols-[200px_1fr] gap-4 items-center",children:[e.jsx(l,{className:"font-medium",children:"Authenticate Locally for MAC"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{checked:a.authenticateLocallyForMac,onCheckedChange:s=>w(c=>({...c,authenticateLocallyForMac:s}))}),e.jsx("span",{className:"text-sm text-muted-foreground",children:a.authenticateLocallyForMac?"Enabled":"Disabled"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(j,{onClick:ue,children:"Save Configuration"})})]})]}),e.jsxs(we,{defaultValue:"radius",className:"w-full",children:[e.jsxs(Se,{className:"grid w-full grid-cols-3",children:[e.jsxs(_,{value:"radius",className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"RADIUS Servers"]}),e.jsxs(_,{value:"ldap",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"LDAP Configurations"]}),e.jsxs(_,{value:"local",className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Local Password Repository"]})]}),e.jsx(V,{value:"radius",className:"space-y-4",children:e.jsxs(H,{className:"surface-2dp border-border",children:[e.jsxs("div",{className:"p-4 border-b border-border flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:"RADIUS Servers"}),e.jsxs(j,{size:"sm",onClick:()=>{d(null),r(!0)},className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Add Server"]})]}),e.jsx("div",{className:"p-4",children:i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(le,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No RADIUS servers configured"}),e.jsx(j,{variant:"outline",className:"mt-4",onClick:()=>r(!0),children:"Add Your First Server"})]}):e.jsxs($,{children:[e.jsx(Y,{children:e.jsxs(D,{children:[e.jsx(m,{children:"Name"}),e.jsx(m,{children:"IP Address"}),e.jsx(m,{children:"Port"}),e.jsx(m,{children:"Timeout"}),e.jsx(m,{children:"Type"}),e.jsx(m,{children:"Status"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsx(K,{children:i.map(s=>e.jsxs(D,{children:[e.jsx(u,{className:"font-medium",children:s.name}),e.jsx(u,{children:s.ipAddress}),e.jsx(u,{children:s.port}),e.jsxs(u,{children:[s.timeout,"s"]}),e.jsx(u,{children:s.isPrimary?e.jsx(y,{variant:"default",children:"Primary"}):e.jsx(y,{variant:"secondary",children:"Backup"})}),e.jsx(u,{children:e.jsxs(y,{variant:s.status==="active"?"default":"secondary",className:"flex items-center gap-1 w-fit",children:[s.status==="active"?e.jsx(k,{className:"h-3 w-3"}):e.jsx(L,{className:"h-3 w-3"}),s.status]})}),e.jsx(u,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>{d(s),r(!0)},children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>je(s.id),children:e.jsx(G,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})}),e.jsx(V,{value:"ldap",className:"space-y-4",children:e.jsxs(H,{className:"surface-2dp border-border",children:[e.jsxs("div",{className:"p-4 border-b border-border flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:"LDAP Configurations"}),e.jsxs(j,{size:"sm",onClick:()=>{E(null),P(!0)},className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Add Configuration"]})]}),e.jsx("div",{className:"p-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ce,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No LDAP configurations found"}),e.jsx(j,{variant:"outline",className:"mt-4",onClick:()=>P(!0),children:"Add Your First Configuration"})]}):e.jsxs($,{children:[e.jsx(Y,{children:e.jsxs(D,{children:[e.jsx(m,{children:"Configuration Name"}),e.jsx(m,{children:"Connection URL"}),e.jsx(m,{children:"Administrator"}),e.jsx(m,{children:"User Search Root"}),e.jsx(m,{children:"Status"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsx(K,{children:h.map(s=>e.jsxs(D,{children:[e.jsx(u,{className:"font-medium",children:s.configurationName}),e.jsx(u,{className:"max-w-[250px] truncate",children:s.connectionUrl}),e.jsx(u,{children:s.administratorUsername}),e.jsx(u,{className:"max-w-[200px] truncate",children:s.userSearchRoot}),e.jsx(u,{children:e.jsxs(y,{variant:s.status==="connected"?"default":"secondary",className:"flex items-center gap-1 w-fit",children:[s.status==="connected"?e.jsx(k,{className:"h-3 w-3"}):e.jsx(L,{className:"h-3 w-3"}),s.status]})}),e.jsx(u,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>{E(s),P(!0)},children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>fe(s.id),children:e.jsx(G,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})}),e.jsx(V,{value:"local",className:"space-y-4",children:e.jsxs(H,{className:"surface-2dp border-border",children:[e.jsxs("div",{className:"p-4 border-b border-border flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:"Local Users"}),e.jsxs(j,{size:"sm",onClick:()=>{z(null),R(!0)},className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Add User"]})]}),e.jsx("div",{className:"p-4",children:ne.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(de,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No local users found"}),e.jsx(j,{variant:"outline",className:"mt-4",onClick:()=>R(!0),children:"Add Your First User"})]}):e.jsxs($,{children:[e.jsx(Y,{children:e.jsxs(D,{children:[e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Username"}),e.jsx(m,{children:"Display Name"}),e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Hash Type"}),e.jsx(m,{children:"Last Login"}),e.jsx(m,{className:"text-right",children:"Actions"})]})}),e.jsx(K,{children:ne.map(s=>e.jsxs(D,{children:[e.jsx(u,{children:e.jsx(y,{variant:s.enabled?"default":"secondary",children:s.enabled?"Enabled":"Disabled"})}),e.jsx(u,{className:"font-medium",children:s.username}),e.jsx(u,{children:s.displayName}),e.jsx(u,{children:`${s.firstName} ${s.lastName}`}),e.jsx(u,{children:e.jsx(y,{variant:"secondary",children:s.passwordHashType})}),e.jsx(u,{children:ve(s.lastLogin)}),e.jsx(u,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>{z(s),R(!0)},children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>ge(s.id),children:e.jsx(G,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})})]}),e.jsx(Ce,{open:n,onOpenChange:r,server:b,onSave:xe}),e.jsx(De,{open:oe,onOpenChange:P,config:M,onSave:pe}),e.jsx(be,{open:he,onOpenChange:R,user:O,onSave:Ne})]})}function Ce({open:v,onOpenChange:g,server:a,onSave:w}){const[i,t]=f.useState({name:"",ipAddress:"",port:1812,sharedSecret:"",timeout:5,retries:3,isPrimary:!1});return f.useEffect(()=>{t(a?{name:a.name,ipAddress:a.ipAddress,port:a.port,sharedSecret:a.sharedSecret,timeout:a.timeout,retries:a.retries,isPrimary:a.isPrimary}:{name:"",ipAddress:"",port:1812,sharedSecret:"",timeout:5,retries:3,isPrimary:!1})},[a,v]),e.jsx(ee,{open:v,onOpenChange:g,children:e.jsxs(se,{className:"sm:max-w-[500px]",children:[e.jsxs(ae,{children:[e.jsx(re,{children:a?"Edit RADIUS Server":"Add RADIUS Server"}),e.jsx(te,{children:"Configure RADIUS server settings for authentication"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Server Name"}),e.jsx(p,{id:"name",value:i.name,onChange:n=>t(r=>({...r,name:n.target.value})),placeholder:"Primary RADIUS"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"ipAddress",children:"IP Address"}),e.jsx(p,{id:"ipAddress",value:i.ipAddress,onChange:n=>t(r=>({...r,ipAddress:n.target.value})),placeholder:"192.168.100.1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"port",children:"Port"}),e.jsx(p,{id:"port",type:"number",value:i.port,onChange:n=>t(r=>({...r,port:parseInt(n.target.value)}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"timeout",children:"Timeout (seconds)"}),e.jsx(p,{id:"timeout",type:"number",value:i.timeout,onChange:n=>t(r=>({...r,timeout:parseInt(n.target.value)}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"sharedSecret",children:"Shared Secret"}),e.jsx(p,{id:"sharedSecret",type:"password",value:i.sharedSecret,onChange:n=>t(r=>({...r,sharedSecret:n.target.value})),placeholder:"Enter shared secret"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"retries",children:"Retries"}),e.jsx(p,{id:"retries",type:"number",value:i.retries,onChange:n=>t(r=>({...r,retries:parseInt(n.target.value)}))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{id:"isPrimary",checked:i.isPrimary,onCheckedChange:n=>t(r=>({...r,isPrimary:n}))}),e.jsx(l,{htmlFor:"isPrimary",children:"Set as Primary Server"})]})]}),e.jsxs(ie,{children:[e.jsx(j,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(j,{onClick:()=>w(i),children:a?"Save Changes":"Add Server"})]})]})})}function De({open:v,onOpenChange:g,config:a,onSave:w}){const[i,t]=f.useState({configurationName:"",ldapConfigurationName:"",connectionUrl:"",administratorUsername:"",administratorPassword:"",maskPassword:!0,userSearchRoot:"",hostSearchRoot:"",ouSearchRoot:"",schemaDefinition:"RFC 2307",enabled:!0}),[n,r]=f.useState(!1);f.useEffect(()=>{t(a?{configurationName:a.configurationName,ldapConfigurationName:a.ldapConfigurationName,connectionUrl:a.connectionUrl,administratorUsername:a.administratorUsername,administratorPassword:a.administratorPassword,maskPassword:a.maskPassword,userSearchRoot:a.userSearchRoot,hostSearchRoot:a.hostSearchRoot,ouSearchRoot:a.ouSearchRoot,schemaDefinition:a.schemaDefinition,enabled:a.enabled}:{configurationName:"",ldapConfigurationName:"",connectionUrl:"ldap://",administratorUsername:"",administratorPassword:"",maskPassword:!0,userSearchRoot:"",hostSearchRoot:"",ouSearchRoot:"",schemaDefinition:"RFC 2307",enabled:!0})},[a,v]);const b=async()=>{r(!0);try{await new Promise(d=>setTimeout(d,1500)),x.success("LDAP connection test successful")}catch{x.error("LDAP connection test failed")}finally{r(!1)}};return e.jsx(ee,{open:v,onOpenChange:g,children:e.jsxs(se,{className:"sm:max-w-[600px]",children:[e.jsxs(ae,{children:[e.jsx(re,{children:a?"Edit LDAP Configuration":"Add LDAP Configuration"}),e.jsx(te,{children:"Configure LDAP server for directory authentication"})]}),e.jsxs("div",{className:"space-y-4 py-4 max-h-[60vh] overflow-y-auto",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"configName",children:"Configuration Name"}),e.jsx(p,{id:"configName",value:i.configurationName,onChange:d=>t(h=>({...h,configurationName:d.target.value})),placeholder:"LDAP Configuration Name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"ldapConfigName",children:"LDAP Configuration Name"}),e.jsx(p,{id:"ldapConfigName",value:i.ldapConfigurationName,onChange:d=>t(h=>({...h,ldapConfigurationName:d.target.value})),placeholder:"LDAP Configuration Name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"connectionUrl",children:"Add LDAP Connection URL"}),e.jsx(p,{id:"connectionUrl",value:i.connectionUrl,onChange:d=>t(h=>({...h,connectionUrl:d.target.value})),placeholder:"ldap://x.x.x.x:389"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"LDAP Connection URL"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"adminUsername",children:"Administrator Username"}),e.jsx(p,{id:"adminUsername",value:i.administratorUsername,onChange:d=>t(h=>({...h,administratorUsername:d.target.value})),placeholder:"Administrator Username"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"adminPassword",children:"Administrator Password"}),e.jsx(p,{id:"adminPassword",type:i.maskPassword?"password":"text",value:i.administratorPassword,onChange:d=>t(h=>({...h,administratorPassword:d.target.value})),placeholder:"Administrator Password"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{id:"maskPassword",checked:i.maskPassword,onCheckedChange:d=>t(h=>({...h,maskPassword:d}))}),e.jsx(l,{htmlFor:"maskPassword",children:"Mask"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"userSearchRoot",children:"User Search Root"}),e.jsx(p,{id:"userSearchRoot",value:i.userSearchRoot,onChange:d=>t(h=>({...h,userSearchRoot:d.target.value})),placeholder:"User Search Root"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"hostSearchRoot",children:"Host Search Root"}),e.jsx(p,{id:"hostSearchRoot",value:i.hostSearchRoot,onChange:d=>t(h=>({...h,hostSearchRoot:d.target.value})),placeholder:"Host Search Root"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"ouSearchRoot",children:"OU Search Root"}),e.jsx(p,{id:"ouSearchRoot",value:i.ouSearchRoot,onChange:d=>t(h=>({...h,ouSearchRoot:d.target.value})),placeholder:"OU Search Root"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"schemaDefinition",children:"Schema Definition"}),e.jsxs(J,{value:i.schemaDefinition,onValueChange:d=>t(h=>({...h,schemaDefinition:d})),children:[e.jsx(Q,{children:e.jsx(W,{})}),e.jsxs(Z,{children:[e.jsx(N,{value:"RFC 2307",children:"RFC 2307"}),e.jsx(N,{value:"RFC 2307bis",children:"RFC 2307bis"}),e.jsx(N,{value:"Active Directory",children:"Active Directory"}),e.jsx(N,{value:"OpenLDAP",children:"OpenLDAP"})]})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx(j,{variant:"outline",className:"w-full",onClick:b,disabled:n,children:n?"Testing...":"Test Configuration"})})]}),e.jsxs(ie,{children:[e.jsx(j,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(j,{onClick:()=>w(i),children:a?"Save Changes":"Add Configuration"})]})]})})}function be({open:v,onOpenChange:g,user:a,onSave:w}){const[i,t]=f.useState({enabled:!0,username:"",displayName:"",firstName:"",lastName:"",passwordHashType:"SHA-256",password:"",maskPassword:!0,description:""});return f.useEffect(()=>{t(a?{enabled:a.enabled,username:a.username,displayName:a.displayName,firstName:a.firstName,lastName:a.lastName,passwordHashType:a.passwordHashType,password:"",maskPassword:!0,description:a.description}:{enabled:!0,username:"",displayName:"",firstName:"",lastName:"",passwordHashType:"SHA-256",password:"",maskPassword:!0,description:""})},[a,v]),e.jsx(ee,{open:v,onOpenChange:g,children:e.jsxs(se,{className:"sm:max-w-[500px]",children:[e.jsxs(ae,{children:[e.jsxs(re,{children:["AAA / ",a?"Edit Local User":"Add Local User"]}),e.jsx(te,{children:"Manage local user accounts for authentication"})]}),e.jsxs("div",{className:"space-y-4 py-4 max-h-[60vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{id:"enabled",checked:i.enabled,onCheckedChange:n=>t(r=>({...r,enabled:n}))}),e.jsx(l,{htmlFor:"enabled",children:"Enabled"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"username",children:"Username"}),e.jsx(p,{id:"username",value:i.username,onChange:n=>t(r=>({...r,username:n.target.value})),placeholder:"Username",disabled:!!a})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"displayName",children:"Display Name"}),e.jsx(p,{id:"displayName",value:i.displayName,onChange:n=>t(r=>({...r,displayName:n.target.value})),placeholder:"Display Name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"firstName",children:"First Name"}),e.jsx(p,{id:"firstName",value:i.firstName,onChange:n=>t(r=>({...r,firstName:n.target.value})),placeholder:"First Name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"lastName",children:"Last Name"}),e.jsx(p,{id:"lastName",value:i.lastName,onChange:n=>t(r=>({...r,lastName:n.target.value})),placeholder:"Last Name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"passwordHashType",children:"Password Hash Type"}),e.jsxs(J,{value:i.passwordHashType,onValueChange:n=>t(r=>({...r,passwordHashType:n})),children:[e.jsx(Q,{children:e.jsx(W,{})}),e.jsxs(Z,{children:[e.jsx(N,{value:"SHA-256",children:"SHA-256"}),e.jsx(N,{value:"SHA-512",children:"SHA-512"}),e.jsx(N,{value:"MD5",children:"MD5"}),e.jsx(N,{value:"bcrypt",children:"bcrypt"}),e.jsx(N,{value:"PBKDF2",children:"PBKDF2"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password",children:a?"Password (leave blank to keep current)":"Password"}),e.jsx(p,{id:"password",type:i.maskPassword?"password":"text",value:i.password,onChange:n=>t(r=>({...r,password:n.target.value})),placeholder:a?"Leave blank to keep current":"Password"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{id:"maskPassword",checked:i.maskPassword,onCheckedChange:n=>t(r=>({...r,maskPassword:n}))}),e.jsx(l,{htmlFor:"maskPassword",children:"Mask"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(p,{id:"description",value:i.description,onChange:n=>t(r=>({...r,description:n.target.value})),placeholder:"Description"})]})]}),e.jsxs(ie,{children:[e.jsx(j,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(j,{onClick:()=>w(i),children:a?"Save Changes":"Add User"})]})]})})}export{He as ConfigureAAAPolicies};
